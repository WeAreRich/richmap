{"version":3,"sources":["webpack:///./src/components/common/map/poverty-map/PovertyMap.vue?70fc","webpack:///./src/components/pages/Try.vue?5447","webpack:///./src/services/map-source-animation.service.ts","webpack:///./src/components/pages/Try.vue?5e49","webpack:///./src/components/pages/Try.vue?be0f","webpack:///./src/components/pages/Try.vue","webpack:///./src/components/pages/Try.vue?d4fa","webpack:///./src/components/pages/Try.vue?9c53","webpack:///./src/components/common/map/poverty-map/PovertyMap.vue?4cf6","webpack:///./src/services/Logger/index.ts","webpack:///./src/constants/mapbox.ts","webpack:///./src/components/common/map/poverty-map/PovertyMap.vue?8ace","webpack:///./src/components/common/map/poverty-map/PovertyMap.vue?1ce8","webpack:///./src/components/common/map/poverty-map/PovertyMap.vue?d051","webpack:///./src/components/common/map/poverty-map/PovertyMap.vue","webpack:///./src/services/nominatim.service.ts","webpack:///./src/components/common/map/poverty-map/PovertyMap.vue?9d6a","webpack:///./src/components/pages/Try.vue?5876"],"names":["content","__webpack_require__","module","i","locals","exports","2XyJ","e","n","t","r","o","a","s","l","map_source_animation_service_MapSourceAnimationService","MapSourceAnimationService","map","this","TAG","ID","counter","layers","sourceIds","prototype","addSource","sourceUrl","_this","Promise","resolve","source","type","url","id","push","on","addSources","sourceUrlList","promises","all","showLayer","Logger","info","index","findIndex","item","addLayer","layer","hideLayer","removeLayer","autoDisplay","sort","reAutoDisplay","autoDisplayByRange","start","end","length","setTimeout","reAutoDisplayByRange","p","Object","setPrototypeOf","__proto__","Array","hasOwnProperty","constructor","create","pages_Tryvue_type_script_lang_ts","_super","Try","apply","arguments","mapStyles","mapbox","d","urls","ids","__extends","handleSelect","handleOnMapLoad","handleChange","animationService","animation","then","res","handleShow","handleHide","handleAuto","getOwnPropertyDescriptor","Reflect","decorate","defineProperty","__decorate","vue_property_decorator","components","PovertyMap","vue_runtime_esm","default","component","componentNormalizer","_vm","_h","$createElement","_c","_self","staticStyle","width","margin","on-map-load","_v","click","_l","_s","$event","__webpack_exports__","559u","version","sources","names","mappings","file","sourceRoot","Ce0W","sourcesContent","LdhC","tag","contents","_i","Date","toLocaleTimeString","console","_a","contents_1","log","concat","error","contents_2","contents_3","OK+q","ACCESS_TOKEN","CHINA_BOUNDS","CHINA_CENTER","night-light-2001","night-light-2013","iFuS","c","h","u","poverty_map_PovertyMapvue_type_script_lang_ts","call","FIRST_LEVEL_LAYER_ID","SECOND_LEVEL_LAYER_ID","THIRD_LEVEL_LAYER_ID","borderPaint","line-color","line-width","query","searchItems","nominatimService","nominatim_service","onMapUrlChange","val","oldVal","setStyle","mounted","initMap","mapbox_gl_default","accessToken","Map","container","style","mapUrl","center","maxBounds","b","addControl","NavigationControl","ScaleControl","onMapLoad","handleChangeFirstLevelCheckBox","value","showFirstLevelBorder","handleChangeSecondLevelCheckBox","showSecondLevelBorder","handleChangeThirdLevelCheckBox","showThirdLevelBorder","removeSource","firstLevelLayer","source-layer","paint","secondLevelLayer","f","staticClass","position","attrs","trigger","placement","icon","text-align","slot","display","flex-direction","padding","label","on-change","Nomination","search","keyword","decodeURIComponent","_services_Logger__WEBPACK_IMPORTED_MODULE_0__","trys","fetch","sent","json","e_1","jqtz","ymnH"],"mappings":"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","file":"static/js/5.16fb7ff5673bb04e6f57.js","sourcesContent":["// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js??ref--6-2!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PovertyMap.vue?vue&type=style&index=0&id=24453468&scoped=true&lang=css\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar update = require(\"!../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\")(\"77ae7d2f\", content, true, {});","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticStyle:{\"width\":\"80%\",\"margin\":\"auto\"}},[_c('poverty-map',{on:{\"on-map-load\":_vm.handleOnMapLoad}}),_vm._v(\" \"),_c('Button',{on:{\"click\":_vm.handleChange}},[_vm._v(\"change\")]),_vm._v(\" \"),_c('Button',{on:{\"click\":_vm.handleHide}},[_vm._v(\"hide\")]),_vm._v(\" \"),_c('ol',_vm._l((_vm.ids),function(id){return _c('li',[_vm._v(\"\\n            \"+_vm._s(id)+\"\\n            \"),_c('Button',{on:{\"click\":function($event){_vm.handleShow(id)}}},[_vm._v(\"显示\")])],1)})),_vm._v(\" \"),_c('Button',{on:{\"click\":_vm.handleAuto}},[_vm._v(\"Auto\")])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { Logger } from '@/services/Logger';\r\n\r\nexport class MapSourceAnimationService {\r\n  private TAG = 'MapSourceAnimationService';\r\n  private ID = 'sourceId';\r\n  private counter = 0;\r\n  private layers: mapboxgl.Layer[] = [];\r\n  private sourceIds: string[] = [];\r\n  constructor(private map: mapboxgl.Map) {\r\n  }\r\n\r\n  /**\r\n   * 增加一个地图资源\r\n   * @param {string} sourceUrl\r\n   * @return {Promise<string>}\r\n   */\r\n  public addSource(sourceUrl: string): Promise<string> {\r\n    return new Promise((resolve => {\r\n      let source: mapboxgl.RasterSource = {\r\n        type: 'raster',\r\n        url: sourceUrl\r\n      };\r\n      let id = this.ID + (this.counter++);\r\n      this.map.addSource(id, source);\r\n      this.sourceIds.push(id);\r\n      this.map.on('sourcedata', () => {\r\n        resolve(id);\r\n      });\r\n    }));\r\n  }\r\n\r\n  /**\r\n   * 增加一系列地图资源\r\n   * @param {string[]} sourceUrlList\r\n   * @return {Promise<string[]>}\r\n   */\r\n  public addSources(sourceUrlList: string[]): Promise<string[]> {\r\n    let promises = sourceUrlList.map(\r\n      url => this.addSource(url)\r\n    );\r\n    return Promise.all(promises);\r\n  }\r\n\r\n  /**\r\n   * 显示某一资源对应的图层\r\n   * @param {string} id\r\n   */\r\n  public showLayer(id: string) {\r\n    Logger.info(this.TAG, `id: ${id}`);\r\n    let index = this.layers.findIndex(item => item.id === id);\r\n    if (index > -1) {\r\n      this.map.addLayer(this.layers[index]);\r\n      Logger.info(this.TAG, `exist layer ${id}`);\r\n    } else {\r\n      Logger.info(this.TAG, `not exist layer ${id}`);\r\n      let layer: mapboxgl.Layer = {\r\n        id: id,\r\n        type: 'raster',\r\n        source: id\r\n      };\r\n      this.map.addLayer(layer);\r\n      Logger.info(this.TAG, `add layer ${id}`);\r\n      this.layers.push(layer);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 隐藏某一资源对应的图层\r\n   * @param {string} id\r\n   */\r\n  public hideLayer(id: string) {\r\n    let index = this.layers.findIndex(item => item.id === id);\r\n    if (index > -1) {\r\n      this.map.removeLayer(id);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 自动播放所有资源，从头开始\r\n   */\r\n  public autoDisplay() {\r\n    this.sourceIds.sort();\r\n    Logger.info(this.TAG, this.sourceIds);\r\n    this.reAutoDisplay(0);\r\n  }\r\n\r\n  /**\r\n   * 根据区间来自动播放\r\n   * TODO: 实现，由于开始和结束的时间格式未定，未实现\r\n   * @param start\r\n   * @param end\r\n   */\r\n  public autoDisplayByRange(start: any, end: any) {\r\n\r\n  }\r\n  /**\r\n   * 从头自动 播放的递归实现\r\n   * @param index\r\n   */\r\n  private reAutoDisplay(index) {\r\n    // 递归条件结束\r\n    if (index === this.sourceIds.length) return;\r\n    // 是否有上层\r\n    if (index > 0) {\r\n      this.hideLayer(this.sourceIds[index - 1]);\r\n    }\r\n    // 显示当前\r\n    this.showLayer(this.sourceIds[index]);\r\n    // 递归\r\n    setTimeout(() => {\r\n      this.reAutoDisplay(index + 1);\r\n    }, 1000);\r\n  }\r\n\r\n  private reAutoDisplayByRange() {\r\n\r\n  }\r\n}","import mod from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--1-1!../../../node_modules/tslint-loader/index.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Try.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--1-1!../../../node_modules/tslint-loader/index.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Try.vue?vue&type=script&lang=ts\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport Vue from 'vue';\nimport PovertyMap from '../common/map/poverty-map/PovertyMap.vue';\nimport { Component } from 'vue-property-decorator';\n// import MapQueryComponent from '../map/MapQueryComponent.vue';\nimport { mapStyles } from '../../constants/mapbox';\nimport { MapSourceAnimationService } from '../../services/map-source-animation.service';\nimport { Logger } from '../../services/Logger';\n\n@Component({\n  components: {\n    PovertyMap\n  }\n})\nexport default class Try extends Vue {\n  private TAG = 'Try.vue';\n  private mapStyles = mapStyles;\n  private map: mapboxgl.Map;\n  private animationService: MapSourceAnimationService;\n  private id: string;\n\n  urls = ['mapbox://wenxiangdong.0u7nbzi0', 'mapbox://wenxiangdong.dhr5yy3g'];\n  ids = [];\n\n  index = 'night-light-2013';\n\n  handleSelect(n) {\n    Logger.info(this.TAG, n);\n  }\n\n  handleOnMapLoad(map: mapboxgl.Map) {\n    Logger.info(this.TAG, 'map loaded', map);\n    this.map = map;\n  }\n  handleChange() {\n    Logger.info(this.TAG, 'change');\n    // let url = 'mapbox://wenxiangdong.dhr5yy3g';\n    this.animationService = new MapSourceAnimationService(this.map);\n    let animation = this.animationService;\n    let promises = this.urls.map(\n      url => animation.addSource(url)\n    );\n    this.animationService.addSources(this.urls)\n      .then(res => {\n        Logger.info(this.TAG, res);\n        this.ids = [];\n        this.ids = res;\n      });\n  }\n  handleShow(id) {\n    Logger.info(this.TAG, id);\n    this.animationService.showLayer(id);\n  }\n  handleHide() {\n    if (!this.animationService) return;\n    this.animationService.hideLayer(this.id);\n  }\n\n  handleAuto() {\n    this.animationService.autoDisplay();\n  }\n}\n","import { render, staticRenderFns } from \"./Try.vue?vue&type=template&id=608d1f91\"\nimport script from \"./Try.vue?vue&type=script&lang=ts\"\nexport * from \"./Try.vue?vue&type=script&lang=ts\"\nimport style0 from \"./Try.vue?vue&type=style&index=0&lang=css\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/css-loader/index.js??ref--6-2!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Try.vue?vue&type=style&index=0&lang=css\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar update = require(\"!../../../node_modules/vue-style-loader/lib/addStylesClient.js\")(\"5125f571\", content, true, {});","exports = module.exports = require(\"../../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \"\", \"\", {\"version\":3,\"sources\":[],\"names\":[],\"mappings\":\"\",\"file\":\"Try.vue?vue&type=style&index=0&lang=css\",\"sourceRoot\":\"\"}]);\n\n// exports\n","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \".outer[data-v-24453468]{position:relative;background:inherit;width:100%;box-shadow:0 0 10px rgba(0,0,0,.5)}#map-container[data-v-24453468]{height:600px;width:100%}.border-control[data-v-24453468]{display:inline-block;position:absolute;z-index:999}\", \"\", {\"version\":3,\"sources\":[\"D:/richmap/client-vue/src/components/common/map/poverty-map/src/components/common/map/poverty-map/PovertyMap.vue\"],\"names\":[],\"mappings\":\"AAqLA,wBACA,kBAAA,AAEA,mBAAA,AACA,WAAA,AACA,kCAAA,CACA,AAEA,gCACA,aAAA,AACA,UAAA,CACA,AAEA,iCACA,qBAAA,AACA,kBAAA,AACA,WAAA,CACA\",\"file\":\"PovertyMap.vue?vue&type=style&index=0&id=24453468&scoped=true&lang=css\",\"sourcesContent\":[\"<template>\\r\\n    <div class=\\\"outer\\\">\\r\\n        <div class=\\\"border-control\\\">\\r\\n            <Dropdown trigger=\\\"click\\\" style=\\\"position: relative\\\" placement=\\\"bottom-start\\\">\\r\\n                <Tooltip content=\\\"边界\\\" placement=\\\"right\\\">\\r\\n                    <Button icon=\\\"ios-browsers\\\"></Button>\\r\\n                </Tooltip>\\r\\n                <DropdownMenu slot=\\\"list\\\" style=\\\"text-align: left; width: 130px;\\\">\\r\\n                    <div style=\\\"display: flex; flex-direction: column; padding: 10px;\\\">\\r\\n                        <Checkbox label=\\\"一级行政区边界\\\" @on-change=\\\"handleChangeFirstLevelCheckBox\\\">一级行政区边界</Checkbox>\\r\\n                        <Checkbox label=\\\"二级行政区边界\\\" @on-change=\\\"handleChangeSecondLevelCheckBox\\\">二级行政区边界</Checkbox>\\r\\n                        <Checkbox label=\\\"三级行政区边界\\\" @on-change=\\\"handleChangeThirdLevelCheckBox\\\">三级行政区边界</Checkbox>\\r\\n                    </div>\\r\\n                </DropdownMenu>\\r\\n            </Dropdown>\\r\\n        </div>\\r\\n        <div id=\\\"map-container\\\"></div>\\r\\n    </div>\\r\\n</template>\\r\\n\\r\\n<script lang=\\\"ts\\\">\\r\\n  import Vue from 'vue';\\r\\n  import { Component, Emit, Prop, Watch } from 'vue-property-decorator';\\r\\n  import NominatimService from '../../../../services/nominatim.service';\\r\\n  import { Logger } from '../../../../services/Logger';\\r\\n  import mapboxgl from 'mapbox-gl';\\r\\n  import { ACCESS_TOKEN, CHINA_BOUNDS, CHINA_CENTER } from '../../../../constants/mapbox';\\r\\n  import PlaceItem from '../../../../types/place-item';\\r\\n\\r\\n  @Component\\r\\n  export default class PovertyMap extends Vue {\\r\\n    private TAG = 'PovertyMap';\\r\\n    private FIRST_LEVEL_LAYER_ID = 'first-level';\\r\\n    private SECOND_LEVEL_LAYER_ID = 'second-level';\\r\\n    private THIRD_LEVEL_LAYER_ID = 'third-level';\\r\\n    private borderPaint = {\\r\\n      'line-color': 'rgba(255,255,255,0.5)',\\r\\n      'line-width': 2\\r\\n    };\\r\\n\\r\\n    // 行政区域划分图层\\r\\n    private firstLevelLayer: mapboxgl.Layer;\\r\\n    private secondLevelLayer: mapboxgl.Layer;\\r\\n    private thirdLevelLayer: mapboxgl.Layer;\\r\\n    private map: mapboxgl.Map;\\r\\n\\r\\n\\r\\n    // 基础地图源\\r\\n    @Prop({\\r\\n      default: () => 'mapbox://styles/mapbox/satellite-v9'\\r\\n    })\\r\\n    public mapUrl: string;\\r\\n\\r\\n\\r\\n    @Watch('mapUrl')\\r\\n    onMapUrlChange(val: string, oldVal: string) {\\r\\n      Logger.info(this.TAG, val, oldVal);\\r\\n      this.map.setStyle(val);\\r\\n    }\\r\\n\\r\\n    // data\\r\\n    public query: string;\\r\\n    public searchItems: PlaceItem[];\\r\\n\\r\\n    // services\\r\\n    private nominatimService: NominatimService;\\r\\n\\r\\n    constructor() {\\r\\n      super();\\r\\n      Logger.info(this.TAG, \\\"constructor\\\");\\r\\n      this.query = \\\"\\\";\\r\\n      this.searchItems = [];\\r\\n      this.nominatimService = new NominatimService();\\r\\n    }\\r\\n\\r\\n    mounted() {\\r\\n      Logger.info(this.TAG, \\\"mounted\\\");\\r\\n      this.initMap();\\r\\n    }\\r\\n\\r\\n    private initMap() {\\r\\n      Logger.info(this.TAG, \\\"start init map\\\");\\r\\n      mapboxgl.accessToken = ACCESS_TOKEN;\\r\\n      this.map = new mapboxgl.Map({\\r\\n        container: 'map-container',\\r\\n        style: this.mapUrl,\\r\\n        center: CHINA_CENTER,\\r\\n        maxBounds: CHINA_BOUNDS\\r\\n      });\\r\\n      // 增加控件\\r\\n      this.map.addControl(new mapboxgl.NavigationControl());\\r\\n      this.map.addControl(new mapboxgl.ScaleControl());\\r\\n      // 初始化完成\\r\\n      this.map.on(\\\"load\\\", () => {\\r\\n        this.onMapLoad(this.map);\\r\\n        // console.log(this.map.getZoom());\\r\\n      });\\r\\n    }\\r\\n\\r\\n    /* 事件emit */\\r\\n    // 地图加载完成，返回一个 mapboxgl 地图对象\\r\\n    @Emit()\\r\\n    public onMapLoad(map: mapboxgl.Map) {}\\r\\n\\r\\n    /* 下面是事件处理 */\\r\\n\\r\\n    public handleChangeFirstLevelCheckBox(value) {\\r\\n      if (value) {\\r\\n        this.showFirstLevelBorder();\\r\\n      } else {\\r\\n        this.map.removeLayer(this.FIRST_LEVEL_LAYER_ID);\\r\\n      }\\r\\n    }\\r\\n\\r\\n    public handleChangeSecondLevelCheckBox(value) {\\r\\n      if (value) {\\r\\n        this.showSecondLevelBorder();\\r\\n      } else {\\r\\n        this.map.removeLayer(this.SECOND_LEVEL_LAYER_ID);\\r\\n      }\\r\\n    }\\r\\n\\r\\n    public handleChangeThirdLevelCheckBox(value) {\\r\\n      if (value) {\\r\\n        this.showThirdLevelBorder();\\r\\n      } else {\\r\\n        this.map.removeLayer(this.THIRD_LEVEL_LAYER_ID);\\r\\n        this.map.removeSource(this.FIRST_LEVEL_LAYER_ID);\\r\\n      }\\r\\n    }\\r\\n\\r\\n    public showFirstLevelBorder() {\\r\\n      Logger.info(this.TAG, \\\"show first level border\\\");\\r\\n      // 未加载过\\r\\n      if (!this.firstLevelLayer) {\\r\\n        this.map.addSource(this.FIRST_LEVEL_LAYER_ID, {\\r\\n          type: 'vector',\\r\\n          url: 'mapbox://wenxiangdong.d4tbuoxg'\\r\\n        });\\r\\n        let layer: mapboxgl.Layer = {\\r\\n          id: this.FIRST_LEVEL_LAYER_ID,\\r\\n          type: \\\"line\\\",\\r\\n          source: this.FIRST_LEVEL_LAYER_ID,\\r\\n          'source-layer': 'china-9o3cd8',\\r\\n          paint: this.borderPaint\\r\\n        };\\r\\n        this.firstLevelLayer = layer;\\r\\n      }\\r\\n      this.map.addLayer(this.firstLevelLayer);\\r\\n      this.map.on('sourcedata', this.FIRST_LEVEL_LAYER_ID, () => {\\r\\n        Logger.info(this.TAG, 'load layer');\\r\\n      })\\r\\n    }\\r\\n\\r\\n    public showSecondLevelBorder() {\\r\\n      Logger.info(this.TAG, \\\"showSecondLevelBorder\\\");\\r\\n      // 未加载过\\r\\n      if (!this.secondLevelLayer) {\\r\\n        this.map.addSource(this.SECOND_LEVEL_LAYER_ID, {\\r\\n          type: 'vector',\\r\\n          url: 'mapbox://wenxiangdong.5wsa80lc'\\r\\n        });\\r\\n        let layer: mapboxgl.Layer = {\\r\\n          id: this.SECOND_LEVEL_LAYER_ID,\\r\\n          type: \\\"line\\\",\\r\\n          source: this.SECOND_LEVEL_LAYER_ID,\\r\\n          paint: this.borderPaint,\\r\\n          'source-layer': 'true'\\r\\n        };\\r\\n        this.secondLevelLayer = layer;\\r\\n      }\\r\\n      this.map.addLayer(this.secondLevelLayer);\\r\\n    }\\r\\n\\r\\n    public showThirdLevelBorder() {\\r\\n      Logger.info(this.TAG, \\\"showThirdLevelBorder\\\");\\r\\n    }\\r\\n  }\\r\\n</script>\\r\\n\\r\\n<style scoped>\\r\\n    .outer {\\r\\n        position: relative;\\r\\n        /*background-image: linear-gradient( 135deg, #92FFC0 30%, #00266150 100%);*/\\r\\n        background: inherit;\\r\\n        width: 100%;\\r\\n        box-shadow: rgba(0, 0, 0, 0.5) 0 0 10px;\\r\\n    }\\r\\n\\r\\n    #map-container {\\r\\n        height: 600px;\\r\\n        width: 100%;\\r\\n    }\\r\\n\\r\\n    .border-control {\\r\\n        display: inline-block;\\r\\n        position: absolute;\\r\\n        z-index: 999;\\r\\n    }\\r\\n</style>\"],\"sourceRoot\":\"\"}]);\n\n// exports\n","/*\r\n日志类\r\n */\r\nexport class Logger {\r\n  private instance: Logger;\r\n\r\n  static info(tag, ...contents): void {\r\n    let time = new Date().toLocaleTimeString();\r\n    if (console.info) {\r\n      console.info(`At ${time} in ${tag}`);\r\n      for (let item of contents) {\r\n        console.info(item);\r\n      }\r\n    } else {\r\n      Logger.log(tag, ...contents);\r\n    }\r\n  }\r\n\r\n  static error(tag, ...contents): void {\r\n    let time = new Date().toLocaleTimeString();\r\n    if (console.error) {\r\n      console.error(`At ${time} in ${tag}`);\r\n      for (let item of contents) {\r\n        console.error(item);\r\n      }\r\n    } else {\r\n      Logger.log(tag, ...contents);\r\n    }\r\n  }\r\n\r\n  static log(tag, ...contents): void {\r\n    let time = new Date().toLocaleTimeString();\r\n    console.log(`At ${time} in ${tag}`);\r\n    for (let item of contents) {\r\n      console.log(item);\r\n    }\r\n  }\r\n}\r\n","const ACCESS_TOKEN = 'pk.eyJ1Ijoid2VueGlhbmdkb25nIiwiYSI6ImNqajEyN2owYjBvNHYzdm10c2p2NXowM2kifQ.kixIr8Jwk2mAqmlQCWW88Q';\r\nconst CHINA_BOUNDS = [[70, 17], [140, 55]];\r\nconst CHINA_CENTER = [104.999927, 35.000074];\r\nlet mapStyles = {\r\n  'night-light-2001': 'mapbox://styles/wenxiangdong/cjjuyolqw21sf2rmmrrp13azv',\r\n  'night-light-2013': 'mapbox://styles/wenxiangdong/cjjuzjzid0a1a2ro45v4abumf'\r\n};\r\nconst REC_LAYER_ID = 'rec-layer-id';\r\nconst LINE_LAYER_ID = 'line-layer-id';\r\nexport { ACCESS_TOKEN, CHINA_BOUNDS, CHINA_CENTER, mapStyles, REC_LAYER_ID, LINE_LAYER_ID };\r\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"outer\"},[_c('div',{staticClass:\"border-control\"},[_c('Dropdown',{staticStyle:{\"position\":\"relative\"},attrs:{\"trigger\":\"click\",\"placement\":\"bottom-start\"}},[_c('Tooltip',{attrs:{\"content\":\"边界\",\"placement\":\"right\"}},[_c('Button',{attrs:{\"icon\":\"ios-browsers\"}})],1),_vm._v(\" \"),_c('DropdownMenu',{staticStyle:{\"text-align\":\"left\",\"width\":\"130px\"},attrs:{\"slot\":\"list\"},slot:\"list\"},[_c('div',{staticStyle:{\"display\":\"flex\",\"flex-direction\":\"column\",\"padding\":\"10px\"}},[_c('Checkbox',{attrs:{\"label\":\"一级行政区边界\"},on:{\"on-change\":_vm.handleChangeFirstLevelCheckBox}},[_vm._v(\"一级行政区边界\")]),_vm._v(\" \"),_c('Checkbox',{attrs:{\"label\":\"二级行政区边界\"},on:{\"on-change\":_vm.handleChangeSecondLevelCheckBox}},[_vm._v(\"二级行政区边界\")]),_vm._v(\" \"),_c('Checkbox',{attrs:{\"label\":\"三级行政区边界\"},on:{\"on-change\":_vm.handleChangeThirdLevelCheckBox}},[_vm._v(\"三级行政区边界\")])],1)])],1)],1),_vm._v(\" \"),_c('div',{attrs:{\"id\":\"map-container\"}})])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import mod from \"-!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/ts-loader/index.js??ref--1-1!../../../../../node_modules/tslint-loader/index.js!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PovertyMap.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/ts-loader/index.js??ref--1-1!../../../../../node_modules/tslint-loader/index.js!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PovertyMap.vue?vue&type=script&lang=ts\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport Vue from 'vue';\nimport { Component, Emit, Prop, Watch } from 'vue-property-decorator';\nimport NominatimService from '../../../../services/nominatim.service';\nimport { Logger } from '../../../../services/Logger';\nimport mapboxgl from 'mapbox-gl';\nimport { ACCESS_TOKEN, CHINA_BOUNDS, CHINA_CENTER } from '../../../../constants/mapbox';\nimport PlaceItem from '../../../../types/place-item';\n\n@Component\nexport default class PovertyMap extends Vue {\n  private TAG = 'PovertyMap';\n  private FIRST_LEVEL_LAYER_ID = 'first-level';\n  private SECOND_LEVEL_LAYER_ID = 'second-level';\n  private THIRD_LEVEL_LAYER_ID = 'third-level';\n  private borderPaint = {\n    'line-color': 'rgba(255,255,255,0.5)',\n    'line-width': 2\n  };\n\n  // 行政区域划分图层\n  private firstLevelLayer: mapboxgl.Layer;\n  private secondLevelLayer: mapboxgl.Layer;\n  private thirdLevelLayer: mapboxgl.Layer;\n  private map: mapboxgl.Map;\n\n\n  // 基础地图源\n  @Prop({\n    default: () => 'mapbox://styles/mapbox/satellite-v9'\n  })\n  public mapUrl: string;\n\n\n  @Watch('mapUrl')\n  onMapUrlChange(val: string, oldVal: string) {\n    Logger.info(this.TAG, val, oldVal);\n    this.map.setStyle(val);\n  }\n\n  // data\n  public query: string;\n  public searchItems: PlaceItem[];\n\n  // services\n  private nominatimService: NominatimService;\n\n  constructor() {\n    super();\n    Logger.info(this.TAG, \"constructor\");\n    this.query = \"\";\n    this.searchItems = [];\n    this.nominatimService = new NominatimService();\n  }\n\n  mounted() {\n    Logger.info(this.TAG, \"mounted\");\n    this.initMap();\n  }\n\n  private initMap() {\n    Logger.info(this.TAG, \"start init map\");\n    mapboxgl.accessToken = ACCESS_TOKEN;\n    this.map = new mapboxgl.Map({\n      container: 'map-container',\n      style: this.mapUrl,\n      center: CHINA_CENTER,\n      maxBounds: CHINA_BOUNDS\n    });\n    // 增加控件\n    this.map.addControl(new mapboxgl.NavigationControl());\n    this.map.addControl(new mapboxgl.ScaleControl());\n    // 初始化完成\n    this.map.on(\"load\", () => {\n      this.onMapLoad(this.map);\n      // console.log(this.map.getZoom());\n    });\n  }\n\n  /* 事件emit */\n  // 地图加载完成，返回一个 mapboxgl 地图对象\n  @Emit()\n  public onMapLoad(map: mapboxgl.Map) {}\n\n  /* 下面是事件处理 */\n\n  public handleChangeFirstLevelCheckBox(value) {\n    if (value) {\n      this.showFirstLevelBorder();\n    } else {\n      this.map.removeLayer(this.FIRST_LEVEL_LAYER_ID);\n    }\n  }\n\n  public handleChangeSecondLevelCheckBox(value) {\n    if (value) {\n      this.showSecondLevelBorder();\n    } else {\n      this.map.removeLayer(this.SECOND_LEVEL_LAYER_ID);\n    }\n  }\n\n  public handleChangeThirdLevelCheckBox(value) {\n    if (value) {\n      this.showThirdLevelBorder();\n    } else {\n      this.map.removeLayer(this.THIRD_LEVEL_LAYER_ID);\n      this.map.removeSource(this.FIRST_LEVEL_LAYER_ID);\n    }\n  }\n\n  public showFirstLevelBorder() {\n    Logger.info(this.TAG, \"show first level border\");\n    // 未加载过\n    if (!this.firstLevelLayer) {\n      this.map.addSource(this.FIRST_LEVEL_LAYER_ID, {\n        type: 'vector',\n        url: 'mapbox://wenxiangdong.d4tbuoxg'\n      });\n      let layer: mapboxgl.Layer = {\n        id: this.FIRST_LEVEL_LAYER_ID,\n        type: \"line\",\n        source: this.FIRST_LEVEL_LAYER_ID,\n        'source-layer': 'china-9o3cd8',\n        paint: this.borderPaint\n      };\n      this.firstLevelLayer = layer;\n    }\n    this.map.addLayer(this.firstLevelLayer);\n    this.map.on('sourcedata', this.FIRST_LEVEL_LAYER_ID, () => {\n      Logger.info(this.TAG, 'load layer');\n    })\n  }\n\n  public showSecondLevelBorder() {\n    Logger.info(this.TAG, \"showSecondLevelBorder\");\n    // 未加载过\n    if (!this.secondLevelLayer) {\n      this.map.addSource(this.SECOND_LEVEL_LAYER_ID, {\n        type: 'vector',\n        url: 'mapbox://wenxiangdong.5wsa80lc'\n      });\n      let layer: mapboxgl.Layer = {\n        id: this.SECOND_LEVEL_LAYER_ID,\n        type: \"line\",\n        source: this.SECOND_LEVEL_LAYER_ID,\n        paint: this.borderPaint,\n        'source-layer': 'true'\n      };\n      this.secondLevelLayer = layer;\n    }\n    this.map.addLayer(this.secondLevelLayer);\n  }\n\n  public showThirdLevelBorder() {\n    Logger.info(this.TAG, \"showThirdLevelBorder\");\n  }\n}\n","import { render, staticRenderFns } from \"./PovertyMap.vue?vue&type=template&id=24453468&scoped=true\"\nimport script from \"./PovertyMap.vue?vue&type=script&lang=ts\"\nexport * from \"./PovertyMap.vue?vue&type=script&lang=ts\"\nimport style0 from \"./PovertyMap.vue?vue&type=style&index=0&id=24453468&scoped=true&lang=css\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"24453468\",\n  null\n  \n)\n\nexport default component.exports","import { Logger } from '@/services/Logger';\r\n\r\nexport default class Nomination {\r\n  async search(keyword: string): Promise<any> {\r\n    const url = `http://nominatim.openstreetmap.org/search?format=json&q=${decodeURIComponent(keyword)}`;\r\n    Logger.info(this, `start to fetch ${url}`);\r\n    try {\r\n      let res = await fetch(url);\r\n      res = await res.json();\r\n      Logger.info(this, 'fetch success', res);\r\n      return res;\r\n    } catch (e) {\r\n      Logger.error(this, 'fetch error', e);\r\n      throw e;\r\n    }\r\n  }\r\n}\r\n","import mod from \"-!../../../../../node_modules/extract-text-webpack-plugin/dist/loader.js??ref--6-0!../../../../../node_modules/vue-style-loader/index.js!../../../../../node_modules/css-loader/index.js??ref--6-2!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PovertyMap.vue?vue&type=style&index=0&id=24453468&scoped=true&lang=css\"; export default mod; export * from \"-!../../../../../node_modules/extract-text-webpack-plugin/dist/loader.js??ref--6-0!../../../../../node_modules/vue-style-loader/index.js!../../../../../node_modules/css-loader/index.js??ref--6-2!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PovertyMap.vue?vue&type=style&index=0&id=24453468&scoped=true&lang=css\"","import mod from \"-!../../../node_modules/extract-text-webpack-plugin/dist/loader.js??ref--6-0!../../../node_modules/vue-style-loader/index.js!../../../node_modules/css-loader/index.js??ref--6-2!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Try.vue?vue&type=style&index=0&lang=css\"; export default mod; export * from \"-!../../../node_modules/extract-text-webpack-plugin/dist/loader.js??ref--6-0!../../../node_modules/vue-style-loader/index.js!../../../node_modules/css-loader/index.js??ref--6-2!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Try.vue?vue&type=style&index=0&lang=css\""],"sourceRoot":""}