(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{"+Idh":function(e,t,n){var r=n("JAgP");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals),n("SZ7m")("2a492820",r,!0,{})},"0FeG":function(e,t,n){var r=n("RP/X");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals),n("SZ7m")("f05a513e",r,!0,{})},"35w+":function(e,t,n){var r=n("He5V");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals),n("SZ7m")("32ea82f8",r,!0,{})},"4ATt":function(e,t,n){(e.exports=n("I1BE")(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"MapQueryComponent.vue?vue&type=style&index=0&id=5d0d02db&scoped=true&lang=css",sourceRoot:""}])},"5omG":function(e,t,n){(e.exports=n("I1BE")(!0)).push([e.i,".fixed-consult[data-v-18270efc]{position:fixed;z-index:9999;right:10px;bottom:6%}","",{version:3,sources:["/Users/law/richmap/client-vue/src/components/common/src/components/common/Consulting.vue"],names:[],mappings:"AAqBA,gCACA,eAAA,AACA,aAAA,AACA,WAAA,AACA,SAAA,CACA",file:"Consulting.vue?vue&type=style&index=0&id=18270efc&scoped=true&lang=css",sourcesContent:['<template>\n    <Affix :offset-right="0">\n        <div class="fixed-consult">\n            <Poptip trigger="hover" :title="onlineConsultTitle" :content="onlineConsultContent">\n                <Button icon="chatbox-working" size="large" type="primary">{{onlineConsultTitle}}</Button>\n            </Poptip>\n        </div>\n    </Affix>\n</template>\n<script lang="ts">\n  import {Component, Emit, Inject, Model, Prop, Provide, Vue, Watch} from \'vue-property-decorator\';\n  import SENTENCES from "../../assets/sentences/index";\n\n  @Component\n  export default class Consulting extends Vue {\n    onlineConsultTitle: string = SENTENCES.ONLINE_CONSULT.TITLE;\n    onlineConsultContent: string = SENTENCES.ONLINE_CONSULT.CONTENT;\n  }\n<\/script>\n\n<style scoped>\n    .fixed-consult {\n        position: fixed;\n        z-index: 9999;\n        right: 10px;\n        bottom: 6%;\n    }\n</style>'],sourceRoot:""}])},"5q9u":function(e,t,n){"use strict";var r=n("0FeG");n.n(r).a},"6SOo":function(e,t,n){(e.exports=n("I1BE")(!0)).push([e.i,".outer[data-v-0a168b7f]{position:relative;background:inherit;width:100%;box-shadow:0 0 10px rgba(0,0,0,.5)}#map-container[data-v-0a168b7f]{height:800px;width:100%}.border-control[data-v-0a168b7f]{display:inline-block;position:absolute;z-index:999}","",{version:3,sources:["/Users/law/richmap/client-vue/src/components/common/map/poverty-map/src/components/common/map/poverty-map/PovertyMap.vue"],names:[],mappings:"AAsMA,wBACA,kBAAA,AAEA,mBAAA,AACA,WAAA,AACA,kCAAA,CACA,AAEA,gCACA,aAAA,AACA,UAAA,CACA,AAEA,iCACA,qBAAA,AACA,kBAAA,AACA,WAAA,CACA",file:"PovertyMap.vue?vue&type=style&index=0&id=0a168b7f&scoped=true&lang=css",sourcesContent:["<template>\n    <div class=\"outer\">\n        <div class=\"border-control\">\n            <Dropdown trigger=\"click\" style=\"position: relative\" placement=\"bottom-start\">\n                <Tooltip content=\"边界\" placement=\"right\">\n                    <Button icon=\"ios-browsers\"></Button>\n                </Tooltip>\n                <DropdownMenu slot=\"list\" style=\"text-align: left; width: 130px;\">\n                    <div style=\"display: flex; flex-direction: column; padding: 10px;\">\n                        <Checkbox label=\"一级行政区边界\" @on-change=\"handleChangeFirstLevelCheckBox\">一级行政区边界</Checkbox>\n                        <Checkbox label=\"二级行政区边界\" @on-change=\"handleChangeSecondLevelCheckBox\">二级行政区边界</Checkbox>\n                        <Checkbox label=\"三级行政区边界\" @on-change=\"handleChangeThirdLevelCheckBox\">三级行政区边界</Checkbox>\n                    </div>\n                </DropdownMenu>\n            </Dropdown>\n        </div>\n        <div id=\"map-container\"></div>\n    </div>\n</template>\n\n<script lang=\"ts\">\n  import Vue from 'vue';\n  import { Component, Emit, Prop, Watch } from 'vue-property-decorator';\n  import NominatimService from '../../../../services/nominatim.service';\n  import { Logger } from '../../../../services/Logger';\n  import mapboxgl from 'mapbox-gl';\n  import { ACCESS_TOKEN, CHINA_BOUNDS, CHINA_CENTER, HUBEI_BOUNDS } from '../../../../constants/mapbox';\n  import PlaceItem from '../../../../types/place-item';\n\n  @Component\n  export default class PovertyMap extends Vue {\n    private TAG = 'PovertyMap';\n    private FIRST_LEVEL_LAYER_ID = 'first-level';\n    private SECOND_LEVEL_LAYER_ID = 'second-level';\n    private THIRD_LEVEL_LAYER_ID = 'third-level';\n    private borderPaint = {\n      'line-color': 'rgba(255,255,255,0.5)',\n      'line-width': 2\n    };\n\n    // 行政区域划分图层\n    private firstLevelLayer: mapboxgl.Layer;\n    private secondLevelLayer: mapboxgl.Layer;\n    private thirdLevelLayer: mapboxgl.Layer;\n    private map: mapboxgl.Map;\n\n\n    // 基础地图源\n    @Prop({\n      default: () => 'mapbox://styles/mapbox/satellite-v9'\n    })\n    public mapUrl: string;\n\n\n    @Watch('mapUrl')\n    onMapUrlChange(val: string, oldVal: string) {\n      Logger.info(this.TAG, val, oldVal);\n      this.map.setStyle(val);\n    }\n\n    // data\n    public query: string;\n    public searchItems: PlaceItem[];\n\n    // services\n    private nominatimService: NominatimService;\n\n    constructor() {\n      super();\n      Logger.info(this.TAG, \"constructor\");\n      this.query = \"\";\n      this.searchItems = [];\n      this.nominatimService = new NominatimService();\n    }\n\n    mounted() {\n      Logger.info(this.TAG, \"mounted\");\n      this.initMap();\n    }\n\n    private initMap() {\n      Logger.info(this.TAG, \"start init map\");\n      mapboxgl.accessToken = ACCESS_TOKEN;\n      this.map = new mapboxgl.Map({\n        container: 'map-container',\n        style: this.mapUrl,\n        // center: CHINA_CENTER,\n        maxBounds: HUBEI_BOUNDS\n      });\n      // 增加控件\n      this.map.addControl(new mapboxgl.NavigationControl());\n      this.map.addControl(new mapboxgl.ScaleControl());\n      // 初始化完成\n      this.map.on(\"load\", () => {\n        this.onMapLoad(this.map);\n        // console.log(this.map.getZoom());\n      });\n    }\n\n    /* 事件emit */\n    // 地图加载完成，返回一个 mapboxgl 地图对象\n    @Emit()\n    public onMapLoad(map: mapboxgl.Map) {}\n\n    /* 下面是事件处理 */\n\n    public handleChangeFirstLevelCheckBox(value) {\n      if (value) {\n        this.showFirstLevelBorder();\n      } else {\n        this.map.removeLayer(this.FIRST_LEVEL_LAYER_ID);\n      }\n    }\n\n    public handleChangeSecondLevelCheckBox(value) {\n      if (value) {\n        this.showSecondLevelBorder();\n      } else {\n        this.map.removeLayer(this.SECOND_LEVEL_LAYER_ID);\n      }\n    }\n\n    public handleChangeThirdLevelCheckBox(value) {\n      if (value) {\n        this.showThirdLevelBorder();\n      } else {\n        this.map.removeLayer(this.THIRD_LEVEL_LAYER_ID);\n        this.map.removeSource(this.FIRST_LEVEL_LAYER_ID);\n      }\n    }\n\n    public showFirstLevelBorder() {\n      Logger.info(this.TAG, \"show first level border\");\n      // 未加载过\n      if (!this.firstLevelLayer) {\n        this.map.addSource(this.FIRST_LEVEL_LAYER_ID, {\n          type: 'vector',\n          url: 'mapbox://vsr2018.78vj6bhk'\n        });\n        let layer: mapboxgl.Layer = {\n          id: this.FIRST_LEVEL_LAYER_ID,\n          type: \"line\",\n          source: this.FIRST_LEVEL_LAYER_ID,\n          'source-layer': 'first-6jawx0',\n          paint: this.borderPaint\n        };\n        this.firstLevelLayer = layer;\n      }\n      this.map.addLayer(this.firstLevelLayer);\n      this.map.on('sourcedata', this.FIRST_LEVEL_LAYER_ID, () => {\n        Logger.info(this.TAG, 'load layer');\n      })\n    }\n\n    public showSecondLevelBorder() {\n      Logger.info(this.TAG, \"showSecondLevelBorder\");\n      // 未加载过\n      if (!this.secondLevelLayer) {\n        this.map.addSource(this.SECOND_LEVEL_LAYER_ID, {\n          type: 'vector',\n          url: 'mapbox://vsr2018.050px5x2'\n        });\n        let layer: mapboxgl.Layer = {\n          id: this.SECOND_LEVEL_LAYER_ID,\n          type: \"line\",\n          source: this.SECOND_LEVEL_LAYER_ID,\n          paint: this.borderPaint,\n          'source-layer': 'second-dsvifq'\n        };\n        this.secondLevelLayer = layer;\n      }\n      this.map.addLayer(this.secondLevelLayer);\n    }\n\n    public showThirdLevelBorder() {\n      Logger.info(this.TAG, \"showThirdLevelBorder\");\n      // 未加载过\n      if (!this.thirdLevelLayer) {\n        this.map.addSource(this.THIRD_LEVEL_LAYER_ID, {\n          type: 'vector',\n          url: 'mapbox://vsr2018.5tz0fat5'\n        });\n        let layer: mapboxgl.Layer = {\n          id: this.THIRD_LEVEL_LAYER_ID,\n          type: \"line\",\n          source: this.THIRD_LEVEL_LAYER_ID,\n          paint: this.borderPaint,\n          'source-layer': 'third-dppmjz'\n        };\n        this.thirdLevelLayer = layer;\n      }\n      this.map.addLayer(this.thirdLevelLayer);\n    }\n  }\n<\/script>\n\n\n<style scoped>\n    .outer {\n        position: relative;\n        /*background-image: linear-gradient( 135deg, #92FFC0 30%, #00266150 100%);*/\n        background: inherit;\n        width: 100%;\n        box-shadow: rgba(0, 0, 0, 0.5) 0 0 10px;\n    }\n\n    #map-container {\n        height: 800px;\n        width: 100%;\n    }\n\n    .border-control {\n        display: inline-block;\n        position: absolute;\n        z-index: 999;\n    }\n</style>"],sourceRoot:""}])},He5V:function(e,t,n){(e.exports=n("I1BE")(!0)).push([e.i,".top[data-v-10c4c6d6]{height:100px}","",{version:3,sources:["/Users/law/richmap/client-vue/src/components/pages/src/components/pages/MapHome.vue"],names:[],mappings:"AA4HA,sBACA,YAAA,CACA",file:"MapHome.vue?vue&type=style&index=0&id=10c4c6d6&scoped=true&lang=css",sourcesContent:["<template>\n    <div>\n        <div class=\"top\">\n\n        </div>\n        <layout>\n            <Sider style=\"background-color: white\" hide-trigger>\n                <detect-fixed-side-menu\n                        v-on:child-say=\"chooseMap\"\n                        v-on:on-select-place=\"handleSelectPalce\"\n                        v-on:on-play=\"handlePlayMap\"\n                        v-on:on-stop=\"handleStopMap\"\n                ></detect-fixed-side-menu>\n            </Sider>\n            <Layout>\n                <poverty-map @on-map-load=\"handleOnMapLoad\"></poverty-map>\n                <consulting></consulting>\n            </Layout>\n        </layout>\n    </div>\n</template>\n\n<script lang=\"ts\">\n  import { Vue, Component } from \"vue-property-decorator\";\n  import Consulting from \"../common/Consulting.vue\";\n  import DetectFixedSideMenu from \"../common/DetectFixedSideMenu.vue\";\n  import PovertyMap from \"../common/map/poverty-map/PovertyMap.vue\";\n  import { Logger } from '../../services/Logger';\n  import { MapLocatePositionService } from '../../services/map-locate-position.service';\n  import { MapSourceService } from '../../services/api/map-source/MapSourceService';\n  import { api } from '../../services/api/ApiProvider';\n  import { Message } from '../../services/Message';\n  import { HUBEI_BOUNDS } from '../../constants/mapbox';\n  import { MapSourceAnimationService } from '../../services/map-source-animation.service';\n  import { MapboxSource } from '../../types/mapbox-source';\n\n  @Component({\n    components: {Consulting, DetectFixedSideMenu, PovertyMap}\n  })\n\n  export default class MapHome extends Vue {\n    private TAG = 'MapHome.vue';\n    private map: mapboxgl.Map;\n    private SHOWING_SOURCE = 'showing-source';\n    private sourceApi: MapSourceService;\n    private messageService: Message;\n    private mapAnimationService: MapSourceAnimationService;\n\n    private mapSources: MapboxSource[] = []; // 地图源\n\n    mounted() {\n      this.sourceApi = api.mapSourceService;\n      this.messageService = new Message(this);\n    }\n\n    handleOnMapLoad(map: mapboxgl.Map) {\n      Logger.info(this.TAG, 'map loaded', map);\n      this.map = map;\n      this.mapAnimationService = new MapSourceAnimationService(map);\n    }\n\n    async chooseMap(year, name){\n      console.log(year, name);\n      console.log('in map home');\n      // const map = this.map;\n      if (!this.map) {\n        this.messageService.error('请等待地图组件加载完成...')\n      }\n      // MapLocatePositionService.locateToPosition([place.lon, place.lat], this.map);\n      if (this.map.isSourceLoaded(this.SHOWING_SOURCE)) {\n        this.map.removeLayer(this.SHOWING_SOURCE);\n        this.map.removeSource(this.SHOWING_SOURCE);\n      }\n      try {\n        let res = await this.sourceApi.getByNameAndYear(name, year);\n        const item = res[0];\n        console.log('【MapHome】', item);\n        if (!item) throw new Error('no source result');\n        let source: mapboxgl.RasterSource = {\n          type: 'raster',\n          url: item.url\n        };\n        this.map.addSource(this.SHOWING_SOURCE, source);\n        this.map.addLayer({\n          id: this.SHOWING_SOURCE,\n          type: 'raster',\n\n          source: this.SHOWING_SOURCE\n        });\n      } catch (e) {}\n    }\n\n\n    handleSelectPalce(item) {\n      const bounds = HUBEI_BOUNDS;\n      const lon = item.lon;\n      const lat = item.lat;\n      if (lon < bounds[0][0] || lon > bounds[1][0] || lat < bounds[0][1] || lat > bounds[1][1]) {\n        this.messageService.error('选择的地点超出范围');\n      } else {\n        MapLocatePositionService.locateToPosition([lon, lat], this.map);\n      }\n    }\n\n    async handlePlayMap(startYear, endYear, name) {\n      if (!this.mapSources.length) {\n        try {\n          let res = await this.sourceApi.getByName(name);\n          this.mapSources = res;\n          Logger.info(this.TAG, 'get sources', res);\n          await this.mapAnimationService.addSources(this.mapSources);\n        } catch (e) {}\n      }\n      Logger.info(this.TAG, this.mapSources.length);\n      this.mapAnimationService.autoDisplayByRange(startYear, endYear);\n    }\n\n    handleStopMap() {\n      this.mapAnimationService.hideAllLayer();\n    }\n  }\n<\/script>\n\n<style scoped>\n    .top{\n        height: 100px;\n    }\n</style>"],sourceRoot:""}])},IC00:function(e,t,n){var r=n("6SOo");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals),n("SZ7m")("702ba291",r,!0,{})},JAgP:function(e,t,n){(e.exports=n("I1BE")(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"SearchPlace.vue?vue&type=style&index=0&id=caffb600&scoped=true&lang=css",sourceRoot:""}])},LdhC:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(){function e(){}return e.info=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];if((new Date).toLocaleTimeString(),console.info)for(var o=0,a=n;o<a.length;o++)a[o];else e.log.apply(e,[t].concat(n))},e.error=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];if((new Date).toLocaleTimeString(),console.error)for(var o=0,a=n;o<a.length;o++)a[o];else e.log.apply(e,[t].concat(n))},e.log=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];(new Date).toLocaleTimeString();for(var r=0,o=t;r<o.length;r++)o[r]},e}()},M7Wi:function(e,t,n){"use strict";var r=n("qax6");n.n(r).a},"OK+q":function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"d",function(){return a}),n.d(t,"c",function(){return s}),n.d(t,"b",function(){return o}),n.d(t,"e",function(){return i});var r="pk.eyJ1Ijoid2VueGlhbmdkb25nIiwiYSI6ImNqajEyN2owYjBvNHYzdm10c2p2NXowM2kifQ.kixIr8Jwk2mAqmlQCWW88Q",o=[[108.3,29],[116.3,33.3]],a={"night-light-2001":"mapbox://styles/wenxiangdong/cjjuyolqw21sf2rmmrrp13azv","night-light-2013":"mapbox://styles/wenxiangdong/cjjuzjzid0a1a2ro45v4abumf"},i={hubeiDEM:"mapbox://wenxiangdong.6mjehw01",hubeiGDP:"mapbox://wenxiangdong.aa00vskv",hubeiSlope:"mapbox://wenxiangdong.9vwvp9tc",hubieNightLight:"mapbox://wenxiangdong.527q7f2p"},s="rec-layer-id"},OP0D:function(e,t,n){"use strict";var r,o=n("YKMj"),a=n("4GRs"),i=(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onlineConsultTitle=a.a.ONLINE_CONSULT.TITLE,t.onlineConsultContent=a.a.ONLINE_CONSULT.CONTENT,t}return i(t,e),function(e,t,n,r){var o,a=arguments.length,i=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(a<3?o(i):a>3?o(t,n,i):o(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i}([o.a],t)}(o.d),c=(n("ijpr"),n("KHd+")),l=Object(c.a)(s,function(){var e=this.$createElement,t=this._self._c||e;return t("Affix",{attrs:{"offset-right":0}},[t("div",{staticClass:"fixed-consult"},[t("Poptip",{attrs:{trigger:"hover",title:this.onlineConsultTitle,content:this.onlineConsultContent}},[t("Button",{attrs:{icon:"chatbox-working",size:"large",type:"primary"}},[this._v(this._s(this.onlineConsultTitle))])],1)],1)])},[],!1,null,"18270efc",null);t.a=l.exports},PDH9:function(e,t,n){"use strict";n.r(t);var r,o=n("YKMj"),a=n("OP0D"),i=n("4GRs"),s=n("gtj/"),c=n("Kw5r"),l=n("jF86"),u=n("LdhC"),p=(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),h=function(e){function t(){var t=e.call(this)||this;return t.mapSearch=i.a.SIDE_MENU.MAP_SEARCH,t.TAG="SearchPlace",t.nominatimService=new l.a,t.query="",t.searchItems=[],t}return p(t,e),t.prototype.handleSearch=function(e){return function(e,t,n,r){return new(n||(n=Promise))(function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(i,s)}c((r=r.apply(e,t||[])).next())})}(this,void 0,void 0,function(){var t;return function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}(this,function(n){switch(n.label){case 0:if(u.a.info(this.TAG,"search",e),!e)return[2];n.label=1;case 1:return n.trys.push([1,3,,4]),t=this,[4,this.nominatimService.search(e)];case 2:return t.searchItems=n.sent(),[3,4];case 3:return n.sent(),[3,4];case 4:return[2]}})})},t.prototype.handleSelectPlace=function(e){u.a.info(this.TAG,"select "+e),this.$emit("set-place",e);var t=this.searchItems.findIndex(function(t){return t.display_name===e});if(t<0)u.a.error(this.TAG,"not found "+e);else{var n=this.searchItems[t];this.$emit("on-select-place",n)}},function(e,t,n,r){var o,a=arguments.length,i=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(a<3?o(i):a>3?o(t,n,i):o(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i}([o.a],t)}(c.default),d=(n("Tp3V"),n("KHd+")),f=Object(d.a)(h,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("AutoComplete",{attrs:{placeholder:e.mapSearch,size:"large",clearable:""},on:{"on-select":e.handleSelectPlace,"on-search":e.handleSearch},model:{value:e.query,callback:function(t){e.query=t},expression:"query"}},e._l(e.searchItems,function(t,r){return n("Option",{key:r,attrs:{value:t.display_name}},[n("span",[e._v(e._s(t.display_name))])])}))],1)},[],!1,null,"caffb600",null).exports,y=function(){function e(e){this._vm=e}return e.prototype.info=function(e){this._vm.$Message.info(e)},e.prototype.error=function(e){this._vm.$Message.error(e)},e}(),m=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),v=function(e){function t(){var t=e.call(this)||this;return t.mapYear=i.a.SIDE_MENU.MAP_YEAR,t.selectedYear=void 0,t.dataType="",t.rules={selectedPlace:[{required:!0,message:"地点不能为空",trigger:"blur"}],selectedYear:[{required:!0,message:"年份不能为空",trigger:"blur"}]},t.typeOptions=[{label:"DEM",value:"hubeiDEM"},{label:"GDP",value:"hubeiGDP"},{label:"坡度",value:"hubeiSlope"},{label:"夜间灯光",value:"hubeiNightLight"}],t.messageService=new y(t),t}return m(t,e),t.prototype.handleSelectPlace=function(e){this.selectedPlace=e},t.prototype.handleClickSearch=function(){this.selectedYear?this.dataType?this.$emit("child-say",this.selectedYear.getFullYear(),this.dataType):this.messageService.error("请选择一个类型"):this.messageService.error("请选择一个年份")},function(e,t,n,r){var o,a=arguments.length,i=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(a<3?o(i):a>3?o(t,n,i):o(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i}([Object(o.a)({components:{SearchPlace:f}})],t)}(c.default),b=(n("M7Wi"),Object(d.a)(v,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Form",{ref:"paramsForm",staticStyle:{padding:"20px","background-color":"whitesmoke",margin:"5px","-webkit-border-radius":"5px"},attrs:{ruls:e.rules}},[n("FormItem",{attrs:{prop:"selectedYear"}},[n("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"year",size:"large",placeholder:e.mapYear},model:{value:e.selectedYear,callback:function(t){e.selectedYear=t},expression:"selectedYear"}})],1),e._v(" "),n("FormItem",{attrs:{prop:"selectedPlace"}},[n("Select",{attrs:{placeholder:"数据类型",size:"large"},model:{value:e.dataType,callback:function(t){e.dataType=t},expression:"dataType"}},e._l(e.typeOptions,function(t){return n("Option",{attrs:{value:t.value}},[e._v("\n                "+e._s(t.label)+"\n            ")])}))],1),e._v(" "),n("FormItem",[n("Button",{staticStyle:{width:"100%"},attrs:{type:"primary",size:"large"},on:{click:e.handleClickSearch}},[e._v("确定\n        ")])],1)],1)},[],!1,null,"5d0d02db",null).exports),g=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),S="DetectFixedSideMenu",L=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.dataType="",t.startDate=i.a.SIDE_MENU.START_DATE,t.endDate=i.a.SIDE_MENU.END_DATE,t.mapType=i.a.SIDE_MENU.MAP_TYPE.TITLE,t.mapTypeAdministration=i.a.SIDE_MENU.MAP_TYPE.ADMINISTRATION_MAP,t.mapPoorState=i.a.SIDE_MENU.MAP_TYPE.POOR_STATE,t.mapPoorDetect=i.a.SIDE_MENU.MAP_TYPE.POOR_DETECT,t.mapPoorService=i.a.SIDE_MENU.MAP_TYPE.POOR_SERVICE,t.dataTypeList=[],t.mapTypeList=[],t.startYear=void 0,t.endYear=void 0,t.isPlaying=!1,t.typeOptions=[{label:"DEM",value:"hubeiDEM"},{label:"GDP",value:"hubeiGDP"},{label:"坡度",value:"hubeiSlope"},{label:"夜间灯光",value:"hubeiNightLight"}],t.dataTypeValue=[],t.mapTypeValue=[],t}return g(t,e),t.prototype.listenToMyBoy=function(e,t){this.$emit("child-say",e,t)},t.prototype.mounted=function(){return function(e,t,n,r){return new(n||(n=Promise))(function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(i,s)}c((r=r.apply(e,t||[])).next())})}(this,void 0,void 0,function(){var e;return function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}(this,function(t){switch(t.label){case 0:return e=this,[4,s.a.dataAnalysisService.getPoorState()];case 1:return e.dataTypeList=t.sent(),this.mapTypeList=[{value:this.mapTypeAdministration,label:this.mapTypeAdministration,children:[]},{value:this.mapPoorState,label:this.mapPoorState,children:this.dataTypeList},{value:this.mapPoorDetect,label:this.mapPoorDetect,children:[]},{value:this.mapPoorService,label:this.mapPoorService,children:[]}],this.messageService=new y(this),[2]}})})},t.prototype.handleSelectPlace=function(e){u.a.info(S,e),this.$emit("on-select-place",e)},t.prototype.handlePlay=function(){u.a.info(S,this.startYear,this.endYear,this.dataType),this.startYear&&this.endYear&&this.dataType?(this.isPlaying=!0,this.$emit("on-play",this.startYear.getFullYear(),this.endYear.getFullYear(),this.dataType)):this.messageService.error("请确保填写了各项参数")},t.prototype.handleStop=function(){this.$emit("on-stop"),this.isPlaying=!1},function(e,t,n,r){var o,a=arguments.length,i=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(a<3?o(i):a>3?o(t,n,i):o(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i}([Object(o.a)({components:{SearchPlace:f,MapQueryComponent:b}})],t)}(o.d),A=(n("5q9u"),Object(d.a)(L,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"layout-side"},[n("map-query-component",{on:{"child-say":e.listenToMyBoy}}),e._v(" "),n("div",{staticStyle:{"background-color":"whitesmoke",margin:"5px","-webkit-border-radius":"5px"}},[n("Select",{staticStyle:{padding:"10px 20px"},attrs:{placeholder:"数据类型",size:"large"},model:{value:e.dataType,callback:function(t){e.dataType=t},expression:"dataType"}},e._l(e.typeOptions,function(t){return n("Option",{attrs:{value:t.value}},[e._v("\n                "+e._s(t.label)+"\n            ")])})),e._v(" "),n("DatePicker",{staticStyle:{"padding-left":"20px","padding-right":"20px"},attrs:{type:"year",placeholder:e.startDate},model:{value:e.startYear,callback:function(t){e.startYear=t},expression:"startYear"}}),e._v(" "),n("DatePicker",{staticStyle:{"padding-left":"20px","padding-right":"20px"},attrs:{type:"year",placeholder:e.endDate},model:{value:e.endYear,callback:function(t){e.endYear=t},expression:"endYear"}}),e._v(" "),n("div",{staticStyle:{"text-align":"center"}},[n("Button",{attrs:{type:"text",icon:"play",size:"large",disabled:e.isPlaying},on:{click:e.handlePlay}}),e._v(" "),n("Button",{attrs:{type:"text",icon:"stop",size:"large",disabled:!e.isPlaying},on:{click:e.handleStop}})],1)],1),e._v(" "),n("div",{staticStyle:{"background-color":"whitesmoke",margin:"5px","-webkit-border-radius":"5px"}},[n("SearchPlace",{on:{"on-select-place":e.handleSelectPlace}})],1)],1)},[],!1,null,"6d41a412",null).exports),E=n("iFuS"),x=n("4ZJM"),_=n.n(x),w=n("OK+q"),T=function(){function e(){}return e.locateToBounds=function(e,t,n){void 0===n&&(n=!1),u.a.info("MapLocatePositionService","locateToBounds",e),t.fitBounds(e),n&&t.removeLayer(w.c)},e.locateToPosition=function(e,t,n,r){void 0===n&&(n=7),void 0===r&&(r=!0),t.flyTo({center:e,curve:1,zoom:n}),r&&(this.marker&&this.marker.remove(),this.marker=(new _.a.Marker).setLngLat(e).addTo(t))},e}(),P=function(){function e(e){this.map=e,this.TAG="MapSourceAnimationService",this.ID="sourceId",this.counter=0,this.layers=[],this.sourceIds=[],this.mapboxSources=[]}return e.prototype.addSource=function(e){var t=this;return new Promise(function(n){var r={type:"raster",url:e.url},o=t.ID+t.counter++;e.ID=o,t.map.addSource(o,r),t.sourceIds.push(o),t.map.on("sourcedata",function(){n(o)})})},e.prototype.addSources=function(e){var t=this;this.mapboxSources=e;var n=e.map(function(e){return t.addSource(e)});return Promise.all(n)},e.prototype.showLayer=function(e){u.a.info(this.TAG,"id: "+e);var t=this.layers.findIndex(function(t){return t.id===e.toString()});if(t>-1)this.map.addLayer(this.layers[t]),u.a.info(this.TAG,"exist layer "+e);else{u.a.info(this.TAG,"not exist layer "+e);var n={id:e.toString(),type:"raster",source:e.toString()};this.map.addLayer(n),u.a.info(this.TAG,"add layer "+e),this.layers.push(n)}},e.prototype.hideLayer=function(e){this.layers.findIndex(function(t){return t.id===e.toString()})>-1&&(u.a.info(this.TAG,"remove"),this.map.removeLayer(e.toString()))},e.prototype.autoDisplay=function(){this.sourceIds.sort(),u.a.info(this.TAG,this.sourceIds),this.reAutoDisplay(0)},e.prototype.autoDisplayByRange=function(e,t){var n=this.mapboxSources.filter(function(n){return e<=n.year&&n.year<=t});u.a.info(this.TAG,n),this.reAutoDisplayByRange(n,0)},e.prototype.reAutoDisplay=function(e){var t=this;e!==this.sourceIds.length&&(e>0&&this.hideLayer(this.sourceIds[e-1]),this.showLayer(this.sourceIds[e]),setTimeout(function(){t.reAutoDisplay(e+1)},1e3))},e.prototype.reAutoDisplayByRange=function(e,t){var n=this;t!==e.length&&(t>0&&this.hideLayer(e[t-1].ID),this.showLayer(e[t].ID),setTimeout(function(){n.reAutoDisplay(t+1)},1e3))},e.prototype.hideAllLayer=function(){var e=this;u.a.info(this.TAG,"hide all"),this.layers.forEach(function(t){try{e.map.removeLayer(t.id)}catch(e){}})},e}(),C=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),D=function(e,t,n,r){return new(n||(n=Promise))(function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(i,s)}c((r=r.apply(e,t||[])).next())})},I=function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},O=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.TAG="MapHome.vue",t.SHOWING_SOURCE="showing-source",t.mapSources=[],t}return C(t,e),t.prototype.mounted=function(){this.sourceApi=s.a.mapSourceService,this.messageService=new y(this)},t.prototype.handleOnMapLoad=function(e){u.a.info(this.TAG,"map loaded",e),this.map=e,this.mapAnimationService=new P(e)},t.prototype.chooseMap=function(e,t){return D(this,void 0,void 0,function(){var n,r,o;return I(this,function(a){switch(a.label){case 0:this.map||this.messageService.error("请等待地图组件加载完成..."),this.map.isSourceLoaded(this.SHOWING_SOURCE)&&(this.map.removeLayer(this.SHOWING_SOURCE),this.map.removeSource(this.SHOWING_SOURCE)),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.sourceApi.getByNameAndYear(t,e)];case 2:if(n=a.sent(),!(r=n[0]))throw new Error("no source result");return o={type:"raster",url:r.url},this.map.addSource(this.SHOWING_SOURCE,o),this.map.addLayer({id:this.SHOWING_SOURCE,type:"raster",source:this.SHOWING_SOURCE}),[3,4];case 3:return a.sent(),[3,4];case 4:return[2]}})})},t.prototype.handleSelectPalce=function(e){var t=w.b,n=e.lon,r=e.lat;n<t[0][0]||n>t[1][0]||r<t[0][1]||r>t[1][1]?this.messageService.error("选择的地点超出范围"):T.locateToPosition([n,r],this.map)},t.prototype.handlePlayMap=function(e,t,n){return D(this,void 0,void 0,function(){var r;return I(this,function(o){switch(o.label){case 0:if(this.mapSources.length)return[3,5];o.label=1;case 1:return o.trys.push([1,4,,5]),[4,this.sourceApi.getByName(n)];case 2:return r=o.sent(),this.mapSources=r,u.a.info(this.TAG,"get sources",r),[4,this.mapAnimationService.addSources(this.mapSources)];case 3:case 4:return o.sent(),[3,5];case 5:return u.a.info(this.TAG,this.mapSources.length),this.mapAnimationService.autoDisplayByRange(e,t),[2]}})})},t.prototype.handleStopMap=function(){this.mapAnimationService.hideAllLayer()},function(e,t,n,r){var o,a=arguments.length,i=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(a<3?o(i):a>3?o(t,n,i):o(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i}([Object(o.a)({components:{Consulting:a.a,DetectFixedSideMenu:A,PovertyMap:E.a}})],t)}(o.d),M=(n("zOXF"),Object(d.a)(O,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"top"}),e._v(" "),n("layout",[n("Sider",{staticStyle:{"background-color":"white"},attrs:{"hide-trigger":""}},[n("detect-fixed-side-menu",{on:{"child-say":e.chooseMap,"on-select-place":e.handleSelectPalce,"on-play":e.handlePlayMap,"on-stop":e.handleStopMap}})],1),e._v(" "),n("Layout",[n("poverty-map",{on:{"on-map-load":e.handleOnMapLoad}}),e._v(" "),n("consulting")],1)],1)],1)},[],!1,null,"10c4c6d6",null));t.default=M.exports},"RP/X":function(e,t,n){(e.exports=n("I1BE")(!0)).push([e.i,".layout-side[data-v-6d41a412]{background-color:#fff}","",{version:3,sources:["/Users/law/richmap/client-vue/src/components/common/src/components/common/DetectFixedSideMenu.vue"],names:[],mappings:"AAkJA,8BACA,qBAAA,CACA",file:"DetectFixedSideMenu.vue?vue&type=style&index=0&id=6d41a412&scoped=true&lang=css",sourcesContent:['<template>\n    <div class="layout-side">\n        <map-query-component v-on:child-say="listenToMyBoy"></map-query-component>\n        <div style="background-color:whitesmoke;margin: 5px;-webkit-border-radius: 5px">\n            \x3c!--<Cascader :placeholder="dataType" size="large" :data="dataTypeList" v-model="dataTypeValue"--\x3e\n                      \x3c!--style="padding:20px"></Cascader>--\x3e\n            <Select placeholder="数据类型" size="large" v-model="dataType" style="padding: 10px 20px;">\n                <Option v-for="op in typeOptions" :value="op.value">\n                    {{op.label}}\n                </Option>\n            </Select>\n            <DatePicker\n                    type="year"\n                    :placeholder="startDate"\n                    v-model="startYear"\n                    style="padding-left:20px;padding-right:20px;"></DatePicker>\n            <DatePicker\n                    type="year"\n                    :placeholder="endDate"\n                    v-model="endYear"\n                    style="padding-left:20px;padding-right:20px;"></DatePicker>\n            <div style="text-align: center">\n                <Button type="text" icon="play" size="large" @click="handlePlay" :disabled="isPlaying"></Button>\n                <Button type="text" icon="stop" size="large" @click="handleStop" :disabled="!isPlaying"></Button>\n            </div>\n        </div>\n        <div style="background-color:whitesmoke;margin: 5px;-webkit-border-radius: 5px">\n            <SearchPlace @on-select-place="handleSelectPlace"></SearchPlace>\n        </div>\n        \x3c!--<Cascader :placeholder="mapType" size="large" :data="mapTypeList" v-model="mapTypeValue"--\x3e\n                  \x3c!--style="padding:20px"></Cascader>--\x3e\n    </div>\n</template>\n<script lang="ts">\n  import { Component, Vue } from "vue-property-decorator";\n  import SENTENCES from "../../assets/sentences/index";\n  import { MapTypeOption } from "../../models/MapTypeOption";\n  import { api } from "../../services/api/ApiProvider";\n  import MapQueryComponent from "./map/MapQueryComponent.vue";\n  import SearchPlace from \'./map/SearchPlace\';\n  import { Logger } from \'../../services/Logger\';\n  import { Message } from \'../../services/Message\';\n\n\n  const TAG = \'DetectFixedSideMenu\';\n\n\n  @Component({\n    components: {SearchPlace, MapQueryComponent}\n  })\n  export default class DetectFixedSideMenu extends Vue{\n    dataType: string = \'\';\n    startDate: string = SENTENCES.SIDE_MENU.START_DATE;\n    endDate: string = SENTENCES.SIDE_MENU.END_DATE;\n    mapType: string = SENTENCES.SIDE_MENU.MAP_TYPE.TITLE;\n    mapTypeAdministration: string = SENTENCES.SIDE_MENU.MAP_TYPE.ADMINISTRATION_MAP;\n    mapPoorState: string = SENTENCES.SIDE_MENU.MAP_TYPE.POOR_STATE;\n    mapPoorDetect: string = SENTENCES.SIDE_MENU.MAP_TYPE.POOR_DETECT;\n    mapPoorService: string = SENTENCES.SIDE_MENU.MAP_TYPE.POOR_SERVICE;\n\n    messageService: Message;\n\n    dataTypeList: MapTypeOption[] = [];\n    mapTypeList: MapTypeOption[] = [];\n\n    startYear: Date = undefined;\n    endYear: Date = undefined;\n\n    isPlaying: boolean = false;\n\n    public typeOptions =  [{\n      label: \'DEM\',\n      value: \'hubeiDEM\'\n    }, {\n      label: \'GDP\',\n      value: \'hubeiGDP\'\n    }, {\n      label: \'坡度\',\n      value: \'hubeiSlope\'\n    }, {\n      label: \'夜间灯光\',\n      value: \'hubeiNightLight\'\n    }];\n\n\n    dataTypeValue: string[] = [];\n    mapTypeValue: string[] = [];\n\n    listenToMyBoy(year, place){\n      console.log(year+" "+place);\n      this.$emit(\'child-say\', year, place)\n    }\n\n    async mounted() {\n      // this.dataTypeList = [\'坡度数据\'];\n      this.dataTypeList = await api.dataAnalysisService.getPoorState();\n      this.mapTypeList = [\n        {\n          value: this.mapTypeAdministration,\n          label: this.mapTypeAdministration,\n          children: []\n        },\n        {\n          value: this.mapPoorState,\n          label: this.mapPoorState,\n          children: this.dataTypeList\n        }\n        ,\n        {\n          value: this.mapPoorDetect,\n          label: this.mapPoorDetect,\n          children: []\n        }\n        ,\n        {\n          value: this.mapPoorService,\n          label: this.mapPoorService,\n          children: []\n        }\n      ];\n      this.messageService = new Message(this);\n    };\n\n    handleSelectPlace(item) {\n      Logger.info(TAG, item);\n      this.$emit(\'on-select-place\', item);\n    }\n\n    handlePlay() {\n      Logger.info(TAG, this.startYear, this.endYear, this.dataType);\n      if (!this.startYear || !this.endYear || !this.dataType) {\n        this.messageService.error(\'请确保填写了各项参数\');\n      } else {\n        this.isPlaying = true;\n        this.$emit(\'on-play\', this.startYear.getFullYear(), this.endYear.getFullYear(), this.dataType);\n      }\n    }\n\n    handleStop() {\n      this.$emit(\'on-stop\');\n      this.isPlaying = false;\n    }\n  }\n<\/script>\n\n<style scoped>\n    .layout-side {\n        background-color: white;\n    }\n</style>'],sourceRoot:""}])},Tp3V:function(e,t,n){"use strict";var r=n("+Idh");n.n(r).a},"gtj/":function(e,t,n){"use strict";var r=function(){function e(){}return e.prototype.getPoorState=function(){return function(e,t,n,r){return new(n||(n=Promise))(function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(i,s)}c((r=r.apply(e,t||[])).next())})}(this,void 0,void 0,function(){return function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}(this,function(e){return[2,[{value:"综合贫困排名",label:"综合贫困排名",children:[{value:"VSR指标排名",label:"VSR指标排名",children:[{value:"夜间灯光指标",label:"夜间灯光指标",children:[]}]}]},{value:"分类贫困排名",label:"分类贫困排名",children:[{value:"经济指标排名",label:"经济指标排名",children:[{value:"未来收入",label:"未来收入",children:[]}]}]}]]})})},e}(),o=n("ja1a"),a=function(){function e(){}return e.prototype.getPoorState=function(){return function(e,t,n,r){return new(n||(n=Promise))(function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(i,s)}c((r=r.apply(e,t||[])).next())})}(this,void 0,void 0,function(){return function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}(this,function(e){switch(e.label){case 0:return[4,o.b.fetch({path:"analysis/state"})];case 1:return[2,e.sent().response]}})})},e}(),i=function(){function e(){}return e.prototype.search=function(e){return function(e,t,n,r){return new(n||(n=Promise))(function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(i,s)}c((r=r.apply(e,t||[])).next())})}(this,void 0,void 0,function(){return function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}(this,function(t){switch(t.label){case 0:return[4,o.b.fetch({path:"search",queryParams:{kw:e}})];case 1:return[2,t.sent().response]}})})},e}(),s=function(){function e(){}return e.prototype.search=function(e){return function(e,t,n,r){return new(n||(n=Promise))(function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(i,s)}c((r=r.apply(e,t||[])).next())})}(this,void 0,void 0,function(){return function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}(this,function(e){return[2,void 0]})})},e}(),c=function(e,t,n,r){return new(n||(n=Promise))(function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(i,s)}c((r=r.apply(e,t||[])).next())})},l=function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},u=function(){function e(){}return e.prototype.getByName=function(e){return c(this,void 0,void 0,function(){return l(this,function(t){switch(t.label){case 0:return[4,o.b.fetch({path:"map",queryParams:{name:e}})];case 1:return[2,t.sent().response]}})})},e.prototype.getByNameAndYear=function(e,t){return c(this,void 0,void 0,function(){return l(this,function(n){switch(n.label){case 0:return[4,o.b.fetch({path:"map/year",queryParams:{name:e,year:t}})];case 1:return[2,n.sent().response]}})})},e}(),p=function(e,t,n,r,o){this.ID=e,this.type=t,this.name=n,this.url=r,this.year=o},h=n("OK+q"),d=function(e,t,n,r){return new(n||(n=Promise))(function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(i,s)}c((r=r.apply(e,t||[])).next())})},f=function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},y=new p(1,"raster","hubeiGDP","mapbox://wenxiangdong.aa00vskv",2010),m=function(){function e(){}return e.prototype.getByName=function(e){return d(this,void 0,void 0,function(){var e;return f(this,function(t){return(e=[]).push({ID:1,type:"raster",name:"name",url:h.e.hubeiDEM,year:2010}),e.push({ID:2,type:"raster",name:"name",url:h.e.hubeiGDP,year:2011}),e.push({ID:3,type:"raster",name:"name",url:h.e.hubeiSlope,year:2012}),e.push({ID:4,type:"raster",name:"name",url:h.e.hubieNightLight,year:2013}),[2,e]})})},e.prototype.getByNameAndYear=function(e,t){return d(this,void 0,void 0,function(){return f(this,function(e){return[2,[y]]})})},e}();n.d(t,"a",function(){return v});var v=new function(){this.isMock=!0,this.isMock?(this.dataAnalysisService=new r,this.searchService=new s,this.mapSourceService=new m):(this.dataAnalysisService=new a,this.searchService=new i,this.mapSourceService=new u)}},iFuS:function(e,t,n){"use strict";var r,o=n("Kw5r"),a=n("YKMj"),i=n("jF86"),s=n("LdhC"),c=n("4ZJM"),l=n.n(c),u=n("OK+q"),p=(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),h=function(e,t,n,r){var o,a=arguments.length,i=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(a<3?o(i):a>3?o(t,n,i):o(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i},d=function(e){function t(){var t=e.call(this)||this;return t.TAG="PovertyMap",t.FIRST_LEVEL_LAYER_ID="first-level",t.SECOND_LEVEL_LAYER_ID="second-level",t.THIRD_LEVEL_LAYER_ID="third-level",t.borderPaint={"line-color":"rgba(255,255,255,0.5)","line-width":2},s.a.info(t.TAG,"constructor"),t.query="",t.searchItems=[],t.nominatimService=new i.a,t}return p(t,e),t.prototype.onMapUrlChange=function(e,t){s.a.info(this.TAG,e,t),this.map.setStyle(e)},t.prototype.mounted=function(){s.a.info(this.TAG,"mounted"),this.initMap()},t.prototype.initMap=function(){var e=this;s.a.info(this.TAG,"start init map"),l.a.accessToken=u.a,this.map=new l.a.Map({container:"map-container",style:this.mapUrl,maxBounds:u.b}),this.map.addControl(new l.a.NavigationControl),this.map.addControl(new l.a.ScaleControl),this.map.on("load",function(){e.onMapLoad(e.map)})},t.prototype.onMapLoad=function(e){},t.prototype.handleChangeFirstLevelCheckBox=function(e){e?this.showFirstLevelBorder():this.map.removeLayer(this.FIRST_LEVEL_LAYER_ID)},t.prototype.handleChangeSecondLevelCheckBox=function(e){e?this.showSecondLevelBorder():this.map.removeLayer(this.SECOND_LEVEL_LAYER_ID)},t.prototype.handleChangeThirdLevelCheckBox=function(e){e?this.showThirdLevelBorder():(this.map.removeLayer(this.THIRD_LEVEL_LAYER_ID),this.map.removeSource(this.FIRST_LEVEL_LAYER_ID))},t.prototype.showFirstLevelBorder=function(){var e=this;if(s.a.info(this.TAG,"show first level border"),!this.firstLevelLayer){this.map.addSource(this.FIRST_LEVEL_LAYER_ID,{type:"vector",url:"mapbox://vsr2018.78vj6bhk"});var t={id:this.FIRST_LEVEL_LAYER_ID,type:"line",source:this.FIRST_LEVEL_LAYER_ID,"source-layer":"first-6jawx0",paint:this.borderPaint};this.firstLevelLayer=t}this.map.addLayer(this.firstLevelLayer),this.map.on("sourcedata",this.FIRST_LEVEL_LAYER_ID,function(){s.a.info(e.TAG,"load layer")})},t.prototype.showSecondLevelBorder=function(){if(s.a.info(this.TAG,"showSecondLevelBorder"),!this.secondLevelLayer){this.map.addSource(this.SECOND_LEVEL_LAYER_ID,{type:"vector",url:"mapbox://vsr2018.050px5x2"});var e={id:this.SECOND_LEVEL_LAYER_ID,type:"line",source:this.SECOND_LEVEL_LAYER_ID,paint:this.borderPaint,"source-layer":"second-dsvifq"};this.secondLevelLayer=e}this.map.addLayer(this.secondLevelLayer)},t.prototype.showThirdLevelBorder=function(){if(s.a.info(this.TAG,"showThirdLevelBorder"),!this.thirdLevelLayer){this.map.addSource(this.THIRD_LEVEL_LAYER_ID,{type:"vector",url:"mapbox://vsr2018.5tz0fat5"});var e={id:this.THIRD_LEVEL_LAYER_ID,type:"line",source:this.THIRD_LEVEL_LAYER_ID,paint:this.borderPaint,"source-layer":"third-dppmjz"};this.thirdLevelLayer=e}this.map.addLayer(this.thirdLevelLayer)},h([Object(a.c)({default:function(){return"mapbox://styles/mapbox/satellite-v9"}})],t.prototype,"mapUrl",void 0),h([Object(a.e)("mapUrl")],t.prototype,"onMapUrlChange",null),h([Object(a.b)()],t.prototype,"onMapLoad",null),h([a.a],t)}(o.default),f=(n("xaZo"),n("KHd+")),y=Object(f.a)(d,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"outer"},[n("div",{staticClass:"border-control"},[n("Dropdown",{staticStyle:{position:"relative"},attrs:{trigger:"click",placement:"bottom-start"}},[n("Tooltip",{attrs:{content:"边界",placement:"right"}},[n("Button",{attrs:{icon:"ios-browsers"}})],1),e._v(" "),n("DropdownMenu",{staticStyle:{"text-align":"left",width:"130px"},attrs:{slot:"list"},slot:"list"},[n("div",{staticStyle:{display:"flex","flex-direction":"column",padding:"10px"}},[n("Checkbox",{attrs:{label:"一级行政区边界"},on:{"on-change":e.handleChangeFirstLevelCheckBox}},[e._v("一级行政区边界")]),e._v(" "),n("Checkbox",{attrs:{label:"二级行政区边界"},on:{"on-change":e.handleChangeSecondLevelCheckBox}},[e._v("二级行政区边界")]),e._v(" "),n("Checkbox",{attrs:{label:"三级行政区边界"},on:{"on-change":e.handleChangeThirdLevelCheckBox}},[e._v("三级行政区边界")])],1)])],1)],1),e._v(" "),n("div",{attrs:{id:"map-container"}})])},[],!1,null,"0a168b7f",null);t.a=y.exports},ijpr:function(e,t,n){"use strict";var r=n("lwfW");n.n(r).a},jF86:function(e,t,n){"use strict";var r=n("LdhC"),o=function(){function e(){}return e.prototype.search=function(e){return function(e,t,n,r){return new(n||(n=Promise))(function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(i,s)}c((r=r.apply(e,t||[])).next())})}(this,void 0,void 0,function(){var t,n,o;return function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}(this,function(a){switch(a.label){case 0:t="http://nominatim.openstreetmap.org/search?format=json&q="+decodeURIComponent(e),r.a.info(this,"start to fetch "+t),a.label=1;case 1:return a.trys.push([1,4,,5]),[4,fetch(t)];case 2:return[4,(n=a.sent()).json()];case 3:return n=a.sent(),r.a.info(this,"fetch success",n),[2,n];case 4:throw o=a.sent(),r.a.error(this,"fetch error",o),o;case 5:return[2]}})})},e}();t.a=o},lwfW:function(e,t,n){var r=n("5omG");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals),n("SZ7m")("581b3f76",r,!0,{})},qax6:function(e,t,n){var r=n("4ATt");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals),n("SZ7m")("ecb1f35a",r,!0,{})},xaZo:function(e,t,n){"use strict";var r=n("IC00");n.n(r).a},zOXF:function(e,t,n){"use strict";var r=n("35w+");n.n(r).a}}]);
//# sourceMappingURL=4.79a24282985bdb3aaa3a.js.map