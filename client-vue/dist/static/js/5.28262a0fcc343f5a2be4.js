(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{"2XyJ":function(e,n,t){"use strict";t.r(n);var o,r=t("Kw5r"),i=t("iFuS"),a=t("YKMj"),s=t("OK+q"),l=t("LdhC"),c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p=(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])},function(e,n){function t(){this.constructor=e}o(e,n),e.prototype=null===n?Object.create(n):(t.prototype=n.prototype,new t)}),h=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.TAG="Try.vue",n.mapStyles=s.d,n.urls=["mapbox://wenxiangdong.0u7nbzi0","mapbox://wenxiangdong.dhr5yy3g"],n.ids=[],n.index="night-light-2013",n}return p(n,e),n.prototype.handleSelect=function(e){l.a.info(this.TAG,e)},n.prototype.handleOnMapLoad=function(e){l.a.info(this.TAG,"map loaded",e),this.map=e},n.prototype.handleChange=function(){l.a.info(this.TAG,"change"),this.map.addSource("hubei",{type:"raster",url:"mapbox://vsr2018.2g41qcaf"}),this.map.addLayer({id:"hubei",type:"raster",source:"hubei","source-layer":"1-6zujon"})},n.prototype.handleShow=function(e){l.a.info(this.TAG,e),this.animationService.showLayer(e)},n.prototype.handleHide=function(){this.animationService&&this.animationService.hideLayer(this.id)},n.prototype.handleAuto=function(){this.animationService.autoDisplay()},function(e,n,t,o){var r,i=arguments.length,a=i<3?n:null===o?o=Object.getOwnPropertyDescriptor(n,t):o;if("object"===("undefined"==typeof Reflect?"undefined":c(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,n,t,o);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(n,t,a):r(n,t))||a);return i>3&&a&&Object.defineProperty(n,t,a),a}([Object(a.a)({components:{PovertyMap:i.a}})],n)}(r.default),d=(t("ymnH"),t("KHd+")),u=Object(d.a)(h,function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticStyle:{width:"80%",margin:"auto"}},[t("poverty-map",{on:{"on-map-load":e.handleOnMapLoad}}),e._v(" "),t("Button",{on:{click:e.handleChange}},[e._v("change")]),e._v(" "),t("Button",{on:{click:e.handleHide}},[e._v("hide")]),e._v(" "),t("ol",e._l(e.ids,function(n){return t("li",[e._v("\n            "+e._s(n)+"\n            "),t("Button",{on:{click:function(t){e.handleShow(n)}}},[e._v("显示")])],1)})),e._v(" "),t("Button",{on:{click:e.handleAuto}},[e._v("Auto")])],1)},[],!1,null,null,null);n.default=u.exports},"3IHN":function(e,n,t){var o=t("559u");"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals),t("SZ7m")("2ade9984",o,!0,{})},"4spQ":function(e,n,t){"use strict";var o=t("OLCW");t.n(o).a},"559u":function(e,n,t){(e.exports=t("I1BE")(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"Try.vue?vue&type=style&index=0&lang=css",sourceRoot:""}])},LdhC:function(e,n,t){"use strict";t.d(n,"a",function(){return o});var o=function(){function e(){}return e.info=function(n){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];if((new Date).toLocaleTimeString(),console.info)for(var r=0,i=t;r<i.length;r++)i[r];else e.log.apply(e,[n].concat(t))},e.error=function(n){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];if((new Date).toLocaleTimeString(),console.error)for(var r=0,i=t;r<i.length;r++)i[r];else e.log.apply(e,[n].concat(t))},e.log=function(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];(new Date).toLocaleTimeString();for(var o=0,r=n;o<r.length;o++)r[o]},e}()},"OK+q":function(e,n,t){"use strict";t.d(n,"a",function(){return o}),t.d(n,"d",function(){return i}),t.d(n,"c",function(){return s}),t.d(n,"b",function(){return r}),t.d(n,"e",function(){return a});var o="pk.eyJ1Ijoid2VueGlhbmdkb25nIiwiYSI6ImNqajEyN2owYjBvNHYzdm10c2p2NXowM2kifQ.kixIr8Jwk2mAqmlQCWW88Q",r=[[108.3,29],[116.3,33.3]],i={"night-light-2001":"mapbox://styles/wenxiangdong/cjjuyolqw21sf2rmmrrp13azv","night-light-2013":"mapbox://styles/wenxiangdong/cjjuzjzid0a1a2ro45v4abumf"},a={hubeiDEM:"mapbox://wenxiangdong.6mjehw01",hubeiGDP:"mapbox://wenxiangdong.aa00vskv",hubeiSlope:"mapbox://wenxiangdong.9vwvp9tc",hubieNightLight:"mapbox://wenxiangdong.527q7f2p"},s="rec-layer-id"},OLCW:function(e,n,t){var o=t("heDD");"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals),t("SZ7m")("79222ff1",o,!0,{})},heDD:function(e,n,t){(e.exports=t("I1BE")(!0)).push([e.i,".outer[data-v-104067d7]{position:relative;background:inherit;width:100%;box-shadow:0 0 10px rgba(0,0,0,.5)}#map-container[data-v-104067d7]{height:800px;width:100%}.border-control[data-v-104067d7]{top:10px;left:10px;display:inline-block;position:absolute;z-index:999}","",{version:3,sources:["/Users/law/richmap/client-vue/src/components/common/map/poverty-map/src/components/common/map/poverty-map/PovertyMap.vue"],names:[],mappings:"AAyMA,wBACA,kBAAA,AAEA,mBAAA,AACA,WAAA,AACA,kCAAA,CACA,AAEA,gCACA,aAAA,AACA,UAAA,CACA,AAEA,iCACA,SAAA,AACA,UAAA,AACA,qBAAA,AAEA,kBAAA,AACA,WAAA,CACA",file:"PovertyMap.vue?vue&type=style&index=0&id=104067d7&scoped=true&lang=css",sourcesContent:["<template>\n    <div class=\"outer\">\n        <div class=\"border-control\">\n            <Dropdown trigger=\"click\" style=\"position: relative\" placement=\"bottom-start\">\n                <Tooltip content=\"边界\" placement=\"right\">\n                    <Button icon=\"ios-browsers\"></Button>\n                </Tooltip>\n                <DropdownMenu slot=\"list\" style=\"text-align: left; width: 130px;\">\n                    <div style=\"display: flex; flex-direction: column; padding: 10px;\">\n                        <Checkbox label=\"一级行政区边界\" @on-change=\"handleChangeFirstLevelCheckBox\">一级行政区边界</Checkbox>\n                        <Checkbox label=\"二级行政区边界\" @on-change=\"handleChangeSecondLevelCheckBox\">二级行政区边界</Checkbox>\n                        <Checkbox label=\"三级行政区边界\" @on-change=\"handleChangeThirdLevelCheckBox\">三级行政区边界</Checkbox>\n                    </div>\n                </DropdownMenu>\n            </Dropdown>\n        </div>\n        <div id=\"map-container\"></div>\n    </div>\n</template>\n\n<script lang=\"ts\">\n  import Vue from 'vue';\n  import { Component, Emit, Prop, Watch } from 'vue-property-decorator';\n  import NominatimService from '../../../../services/nominatim.service';\n  import { Logger } from '../../../../services/Logger';\n  import mapboxgl from 'mapbox-gl';\n  import { ACCESS_TOKEN, CHINA_BOUNDS, CHINA_CENTER, HUBEI_BOUNDS } from '../../../../constants/mapbox';\n  import PlaceItem from '../../../../types/place-item';\n  import {Dropdown, Tooltip, DropdownMenu, Checkbox, Button} from 'iview';\n\n  @Component({\n    components: {Dropdown, Tooltip, DropdownMenu, Checkbox, Button}\n  })\n  export default class PovertyMap extends Vue {\n    private TAG = 'PovertyMap';\n    private FIRST_LEVEL_LAYER_ID = 'first-level';\n    private SECOND_LEVEL_LAYER_ID = 'second-level';\n    private THIRD_LEVEL_LAYER_ID = 'third-level';\n    private borderPaint = {\n      'line-color': 'rgba(255,255,255,0.5)',\n      'line-width': 2\n    };\n\n    // 行政区域划分图层\n    private firstLevelLayer: mapboxgl.Layer;\n    private secondLevelLayer: mapboxgl.Layer;\n    private thirdLevelLayer: mapboxgl.Layer;\n    private map: mapboxgl.Map;\n\n\n    // 基础地图源\n    @Prop({\n      default: () => 'mapbox://styles/mapbox/satellite-v9'\n    })\n    public mapUrl: string;\n\n\n    @Watch('mapUrl')\n    onMapUrlChange(val: string, oldVal: string) {\n      Logger.info(this.TAG, val, oldVal);\n      this.map.setStyle(val);\n    }\n\n    // data\n    public query: string;\n    public searchItems: PlaceItem[];\n\n    // services\n    private nominatimService: NominatimService;\n\n    constructor() {\n      super();\n      Logger.info(this.TAG, \"constructor\");\n      this.query = \"\";\n      this.searchItems = [];\n      this.nominatimService = new NominatimService();\n    }\n\n    mounted() {\n      Logger.info(this.TAG, \"mounted\");\n      this.initMap();\n    }\n\n    private initMap() {\n      Logger.info(this.TAG, \"start init map\");\n      mapboxgl.accessToken = ACCESS_TOKEN;\n      this.map = new mapboxgl.Map({\n        container: 'map-container',\n        style: this.mapUrl,\n        // center: CHINA_CENTER,\n        maxBounds: HUBEI_BOUNDS\n      });\n      // 增加控件\n      this.map.addControl(new mapboxgl.NavigationControl());\n      this.map.addControl(new mapboxgl.ScaleControl());\n      // 初始化完成\n      this.map.on(\"load\", () => {\n        this.onMapLoad(this.map);\n        // console.log(this.map.getZoom());\n      });\n    }\n\n    /* 事件emit */\n    // 地图加载完成，返回一个 mapboxgl 地图对象\n    @Emit()\n    public onMapLoad(map: mapboxgl.Map) {}\n\n    /* 下面是事件处理 */\n\n    public handleChangeFirstLevelCheckBox(value) {\n      if (value) {\n        this.showFirstLevelBorder();\n      } else {\n        this.map.removeLayer(this.FIRST_LEVEL_LAYER_ID);\n      }\n    }\n\n    public handleChangeSecondLevelCheckBox(value) {\n      if (value) {\n        this.showSecondLevelBorder();\n      } else {\n        this.map.removeLayer(this.SECOND_LEVEL_LAYER_ID);\n      }\n    }\n\n    public handleChangeThirdLevelCheckBox(value) {\n      if (value) {\n        this.showThirdLevelBorder();\n      } else {\n        this.map.removeLayer(this.THIRD_LEVEL_LAYER_ID);\n        this.map.removeSource(this.FIRST_LEVEL_LAYER_ID);\n      }\n    }\n\n    public showFirstLevelBorder() {\n      Logger.info(this.TAG, \"show first level border\");\n      // 未加载过\n      if (!this.firstLevelLayer) {\n        this.map.addSource(this.FIRST_LEVEL_LAYER_ID, {\n          type: 'vector',\n          url: 'mapbox://vsr2018.78vj6bhk'\n        });\n        let layer: mapboxgl.Layer = {\n          id: this.FIRST_LEVEL_LAYER_ID,\n          type: \"line\",\n          source: this.FIRST_LEVEL_LAYER_ID,\n          'source-layer': 'first-6jawx0',\n          paint: this.borderPaint\n        };\n        this.firstLevelLayer = layer;\n      }\n      this.map.addLayer(this.firstLevelLayer);\n      this.map.on('sourcedata', this.FIRST_LEVEL_LAYER_ID, () => {\n        Logger.info(this.TAG, 'load layer');\n      })\n    }\n\n    public showSecondLevelBorder() {\n      Logger.info(this.TAG, \"showSecondLevelBorder\");\n      // 未加载过\n      if (!this.secondLevelLayer) {\n        this.map.addSource(this.SECOND_LEVEL_LAYER_ID, {\n          type: 'vector',\n          url: 'mapbox://vsr2018.050px5x2'\n        });\n        let layer: mapboxgl.Layer = {\n          id: this.SECOND_LEVEL_LAYER_ID,\n          type: \"line\",\n          source: this.SECOND_LEVEL_LAYER_ID,\n          paint: this.borderPaint,\n          'source-layer': 'second-dsvifq'\n        };\n        this.secondLevelLayer = layer;\n      }\n      this.map.addLayer(this.secondLevelLayer);\n    }\n\n    public showThirdLevelBorder() {\n      Logger.info(this.TAG, \"showThirdLevelBorder\");\n      // 未加载过\n      if (!this.thirdLevelLayer) {\n        this.map.addSource(this.THIRD_LEVEL_LAYER_ID, {\n          type: 'vector',\n          url: 'mapbox://vsr2018.5tz0fat5'\n        });\n        let layer: mapboxgl.Layer = {\n          id: this.THIRD_LEVEL_LAYER_ID,\n          type: \"line\",\n          source: this.THIRD_LEVEL_LAYER_ID,\n          paint: this.borderPaint,\n          'source-layer': 'third-dppmjz'\n        };\n        this.thirdLevelLayer = layer;\n      }\n      this.map.addLayer(this.thirdLevelLayer);\n    }\n  }\n<\/script>\n\n\n<style scoped>\n    .outer {\n        position: relative;\n        /*background-image: linear-gradient( 135deg, #92FFC0 30%, #00266150 100%);*/\n        background: inherit;\n        width: 100%;\n        box-shadow: rgba(0, 0, 0, 0.5) 0 0 10px;\n    }\n\n    #map-container {\n        height: 800px;\n        width: 100%;\n    }\n\n    .border-control {\n        top: 10px;\n        left: 10px;\n        display: inline-block;\n        /*width: 20px;*/\n        position: absolute;\n        z-index: 999;\n    }\n</style>"],sourceRoot:""}])},iFuS:function(e,n,t){"use strict";var o,r=t("AfiY"),i=t("YGYh"),a=t("aICe"),s=t("fR+o"),l=t("+IY/"),c=t("Kw5r"),p=t("YKMj"),h=t("jF86"),d=t("LdhC"),u=t("4ZJM"),f=t.n(u),m=t("OK+q"),v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},L=(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])},function(e,n){function t(){this.constructor=e}o(e,n),e.prototype=null===n?Object.create(n):(t.prototype=n.prototype,new t)}),y=function(e,n,t,o){var r,i=arguments.length,a=i<3?n:null===o?o=Object.getOwnPropertyDescriptor(n,t):o;if("object"===("undefined"==typeof Reflect?"undefined":v(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,n,t,o);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(n,t,a):r(n,t))||a);return i>3&&a&&Object.defineProperty(n,t,a),a},b=function(e){function n(){var n=e.call(this)||this;return n.TAG="PovertyMap",n.FIRST_LEVEL_LAYER_ID="first-level",n.SECOND_LEVEL_LAYER_ID="second-level",n.THIRD_LEVEL_LAYER_ID="third-level",n.borderPaint={"line-color":"rgba(255,255,255,0.5)","line-width":2},d.a.info(n.TAG,"constructor"),n.query="",n.searchItems=[],n.nominatimService=new h.a,n}return L(n,e),n.prototype.onMapUrlChange=function(e,n){d.a.info(this.TAG,e,n),this.map.setStyle(e)},n.prototype.mounted=function(){d.a.info(this.TAG,"mounted"),this.initMap()},n.prototype.initMap=function(){var e=this;d.a.info(this.TAG,"start init map"),f.a.accessToken=m.a,this.map=new f.a.Map({container:"map-container",style:this.mapUrl,maxBounds:m.b}),this.map.addControl(new f.a.NavigationControl),this.map.addControl(new f.a.ScaleControl),this.map.on("load",function(){e.onMapLoad(e.map)})},n.prototype.onMapLoad=function(e){},n.prototype.handleChangeFirstLevelCheckBox=function(e){e?this.showFirstLevelBorder():this.map.removeLayer(this.FIRST_LEVEL_LAYER_ID)},n.prototype.handleChangeSecondLevelCheckBox=function(e){e?this.showSecondLevelBorder():this.map.removeLayer(this.SECOND_LEVEL_LAYER_ID)},n.prototype.handleChangeThirdLevelCheckBox=function(e){e?this.showThirdLevelBorder():(this.map.removeLayer(this.THIRD_LEVEL_LAYER_ID),this.map.removeSource(this.FIRST_LEVEL_LAYER_ID))},n.prototype.showFirstLevelBorder=function(){var e=this;if(d.a.info(this.TAG,"show first level border"),!this.firstLevelLayer){this.map.addSource(this.FIRST_LEVEL_LAYER_ID,{type:"vector",url:"mapbox://vsr2018.78vj6bhk"});var n={id:this.FIRST_LEVEL_LAYER_ID,type:"line",source:this.FIRST_LEVEL_LAYER_ID,"source-layer":"first-6jawx0",paint:this.borderPaint};this.firstLevelLayer=n}this.map.addLayer(this.firstLevelLayer),this.map.on("sourcedata",this.FIRST_LEVEL_LAYER_ID,function(){d.a.info(e.TAG,"load layer")})},n.prototype.showSecondLevelBorder=function(){if(d.a.info(this.TAG,"showSecondLevelBorder"),!this.secondLevelLayer){this.map.addSource(this.SECOND_LEVEL_LAYER_ID,{type:"vector",url:"mapbox://vsr2018.050px5x2"});var e={id:this.SECOND_LEVEL_LAYER_ID,type:"line",source:this.SECOND_LEVEL_LAYER_ID,paint:this.borderPaint,"source-layer":"second-dsvifq"};this.secondLevelLayer=e}this.map.addLayer(this.secondLevelLayer)},n.prototype.showThirdLevelBorder=function(){if(d.a.info(this.TAG,"showThirdLevelBorder"),!this.thirdLevelLayer){this.map.addSource(this.THIRD_LEVEL_LAYER_ID,{type:"vector",url:"mapbox://vsr2018.5tz0fat5"});var e={id:this.THIRD_LEVEL_LAYER_ID,type:"line",source:this.THIRD_LEVEL_LAYER_ID,paint:this.borderPaint,"source-layer":"third-dppmjz"};this.thirdLevelLayer=e}this.map.addLayer(this.thirdLevelLayer)},y([Object(p.c)({default:function(){return"mapbox://styles/mapbox/satellite-v9"}})],n.prototype,"mapUrl",void 0),y([Object(p.e)("mapUrl")],n.prototype,"onMapUrlChange",null),y([Object(p.b)()],n.prototype,"onMapLoad",null),y([Object(p.a)({components:{Dropdown:l.a,Tooltip:s.a,DropdownMenu:a.a,Checkbox:i.a,Button:r.a}})],n)}(c.default),g=(t("4spQ"),t("KHd+")),A=Object(g.a)(b,function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"outer"},[t("div",{staticClass:"border-control"},[t("Dropdown",{staticStyle:{position:"relative"},attrs:{trigger:"click",placement:"bottom-start"}},[t("Tooltip",{attrs:{content:"边界",placement:"right"}},[t("Button",{attrs:{icon:"ios-browsers"}})],1),e._v(" "),t("DropdownMenu",{staticStyle:{"text-align":"left",width:"130px"},attrs:{slot:"list"},slot:"list"},[t("div",{staticStyle:{display:"flex","flex-direction":"column",padding:"10px"}},[t("Checkbox",{attrs:{label:"一级行政区边界"},on:{"on-change":e.handleChangeFirstLevelCheckBox}},[e._v("一级行政区边界")]),e._v(" "),t("Checkbox",{attrs:{label:"二级行政区边界"},on:{"on-change":e.handleChangeSecondLevelCheckBox}},[e._v("二级行政区边界")]),e._v(" "),t("Checkbox",{attrs:{label:"三级行政区边界"},on:{"on-change":e.handleChangeThirdLevelCheckBox}},[e._v("三级行政区边界")])],1)])],1)],1),e._v(" "),t("div",{attrs:{id:"map-container"}})])},[],!1,null,"104067d7",null);n.a=A.exports},jF86:function(e,n,t){"use strict";var o=t("LdhC"),r=function(){function e(){}return e.prototype.search=function(e){return function(e,n,t,o){return new(t||(t=Promise))(function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){e.done?r(e.value):new t(function(n){n(e.value)}).then(a,s)}l((o=o.apply(e,n||[])).next())})}(this,void 0,void 0,function(){var n,t,r;return function(e,n){var t,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;a;)try{if(t=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=n.call(e,a)}catch(e){i=[6,e],o=0}finally{t=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}(this,function(i){switch(i.label){case 0:n="https://nominatim.openstreetmap.org/search?format=json&q="+decodeURIComponent(e),o.a.info(this,"start to fetch "+n),i.label=1;case 1:return i.trys.push([1,4,,5]),[4,fetch(n)];case 2:return[4,(t=i.sent()).json()];case 3:return t=i.sent(),o.a.info(this,"fetch success",t),[2,t];case 4:throw r=i.sent(),o.a.error(this,"fetch error",r),r;case 5:return[2]}})})},e}();n.a=r},ymnH:function(e,n,t){"use strict";var o=t("3IHN");t.n(o).a}}]);
//# sourceMappingURL=5.28262a0fcc343f5a2be4.js.map